!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?exports["widget-advanced-content-template"]=t(require("jquery")):e["widget-advanced-content-template"]=t(e.jquery)}(this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var o;(function(e){o=function(require,e,t){"use strict";function o(e){return e.find(".lp-background-image:first img").prop("src")}t.name="widget-advanced-content-template";var i=n(2),a=n(3),r={},d=function(e){var t=i("#main"),n=r[e];n||(n=i("<div class=lp-full-bg />").css("background-image","url("+e+")"),t.prepend(n),r[e]=n);var o=t.children(".lp-full-bg").not(n);o.fadeOut(1e3),n.fadeIn(0===o.length?0:1e3)},s=function(e){var t="[contenteditable=false]:not(img)",n=function(){var e,t,n=window.CKEDITOR;if(n&&n.instances)for(e in n.instances)if(t=n.instances[e],this===t.element.$)return t.destroy(),i(this).attr("contenteditable",!0),void n.inline(this)};i(e.body).off(".lp-ice").on("focus.lp-ice",t,function(){i(e.body).find(t).each(n)}).find(t).each(n)},c=function(e){var t=new i.Deferred;if(be.ice&&bd&&"true"===bd.designMode){e.iceConfig=i.extend(!0,{},be.ice.config),e.iceConfig.events.push("lp-drag");var n=top&&top.bd&&top.bd.PageMgmtTree&&top.bd.PageMgmtTree.selectedLink&&top.bd.PageMgmtTree.selectedLink.isMasterPage,o=n||"true"===e.model.manageable||""===e.model.manageable||void 0===e.model.manageable;if(o&&be.ice.controller){var a=String(e.getPreference("templateUrl")),r=function(){return be.ice.controller.edit(e,a).then(function(t){return i(e.body).find(".bp-g-include").html(t),s(e),t})};return r()}}else i('img[src=""], img:not([src])',e.body).addClass("be-ice-hide-image"),t.resolve();return t.promise()},l=function(e){this.widget=e,this.$widget=i(e.body)};l.prototype.init=function(){c(this.widget);var e="lp-icon-caret-up",t="lp-icon-caret-down",n=i(".lp-faq-content",this.$widget),o=i(".lp-accordion-toggle-class");i(".lp-faq-title",this.$widget).click(function(){var a=i(this),r=a.hasClass("collapsed");r?(o.removeClass(t).addClass(e),n.slideDown(300)):(o.removeClass(e).addClass(t),n.slideUp(300)),a.toggleClass("collapsed",!r)})};var u=function(e){var t=this;t.widget=e,e.updateBackground=function(){t.setBackground()},t.$widget=i(e.body)};u.prototype.init=function(){var e=this;c(e.widget).then(function(){function t(){e.setBackground(),"launchpad:show"===i(e.widget.htmlNode).attr("data-event")&&i(e.widget.htmlNode).removeAttr("data-event")}if(e.DraggableICEBehavior=new a(e.widget,{}),e.DraggableICEBehavior.init(bd.designMode),e.setHeight(),e.$widget.is(":visible")&&e.setBackground(),e.widget.model.addEventListener("PrefModified",function(t){"ImageOne"===t.attrName&&(e.setHeight(),e.setBackground())}),i(e.widget.htmlNode).on("launchpad:show",function(){t()}),"launchpad:show"===i(e.widget.htmlNode).attr("data-event")&&t(),bd.designMode){for(var n,r=e.widget;r.parentNode;){if(r=r.parentNode,"TCont"===r.nodeName){var d=r;break}n=r}d&&i(d.htmlNode).find(".bp-tContFn-tab").on("click",function(t){var a=d.childNodes.indexOf(n),r=i(t.currentTarget).index();r=(r+1)%d.childNodes.length,a===r&&o(i(n.htmlNode))===o(e.$widget)&&e.setBackground()})}})},u.prototype.setHeight=function(){var e=this.widget.getPreference("height");e&&this.$widget.height(e)},u.prototype.setBackground=function(){s(this.widget);var e=o(this.$widget);if(e&&-1===e.indexOf("blank.gif")){var t=this.widget.getPreference("setPageBackground");t?d(e):this.$widget.css({"background-image":"url("+e+")","background-repeat":"no-repeat","background-size":"100% 100%"})}};var f=function(e){this.widget=e};f.prototype.init=function(){var e,t=/content\/accordion/.test(this.widget.model.getPreference("templateUrl"));return e=t?new l(this.widget):new u(this.widget),e.init(),e},t.exports=function(e){var t=window.gadgets;t&&t.pubsub&&"function"==typeof t.pubsub.publish&&window.gadgets.pubsub.publish("cxp.item.loaded",{id:e.model.name});var n=new f(e);return n.init()}}.call(t,n,t,e),!(void 0!==o&&(e.exports=o))}).call(t,n(1)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(t,n){t.exports=e},function(e,t,n){var o;o=function(require,e,t){"use strict";var o,i=n(2),a=function(e,t){var n,o,a=i.extend({draggableAreaSelector:".lp-content-text-area",containersSelector:".lp-promo-slide",grippyContents:"Drag",draggableClass:"draggable",preferenceName:"content-position",defaultCoordinates:{top:"50px",left:"50px"}},t),r=i(e.body),d="lp-grippy",s=400,c=!0,l=function(e,t,n){n=i.extend({onStop:function(){},prevent:!0},n);var o,d=function(){e.removeClass(a.draggableClass),e.parents().unbind("mousemove",o),i(document).unbind("mouseup",d),n.onStop(e)};t.on("mousedown",function(t){n.prevent&&(t.preventDefault(),t.stopPropagation()),e.addClass(a.draggableClass);var s=e.outerHeight(),c=e.outerWidth(),l=e.offset().top+s-t.pageY,u=e.offset().left+c-t.pageX;o=function(t){var n=t.pageY+l-s,o=t.pageX+u-c,i=r.offset().top,a=i+r.outerHeight(),d=r.offset().left,f=d+r.outerWidth();i>n||n>a-20||d>o||o>f-20||e.offset({top:n,left:o})},e.parents().on("mousemove",o),i(document).on("mouseup",d)})},u=function(t,n){o[t]={top:n.css("top"),left:n.css("left")},e.setPreference(a.preferenceName,JSON.stringify(o)),e.model.save()},f=function(e){var t=i("<div/>").text(a.grippyContents).addClass(d).appendTo(e);t.hover(function(){t.data("is:hover",!0)},function(){t.data("is:hover",!1)}),e.hover(function(){t.show(),t.data("timeout")&&clearTimeout(t.data("timeout"))},function(){var e=setTimeout(function(){t.data("is:hover")||t.hide()},500);t.data("timeout",e)}),l(e,t,{onStop:function(e){u(e.attr("id"),e)}})},p=function(){n=i(a.containersSelector,r),n.each(function(e,t){var n=i(t).find(a.draggableAreaSelector);c&&f(n),"absolute"!==n.css("position")&&n.css("position","absolute")})},g=function(){var e=n.find(a.draggableAreaSelector),t=o[n.attr("id")];"undefined"!==t&&t||(t={top:a.defaultCoordinates.top,left:a.defaultCoordinates.left}),e.css({top:t.top,left:t.left}),e.animate({opacity:1},s)},h=function(t){c=!!t,p();try{o=JSON.parse(e.getPreference(a.preferenceName))}catch(n){o=a.defaultCoordinates}g()},v=function(e){e=i(e),e.find("."+d).remove(),e.find(a.draggableAreaSelector).css({top:"",left:"",opacity:""})};return{init:h,cleanup:v}},r=be.ice&&be.ice&&be.ice.events;return r&&(r.registerEventListener("lp-drag",function(e,t){o=new a(t,{}),o.init(bd.designMode)}),r.registerEventCleaner("lp-drag",function(e){o.cleanup(e)})),t.exports=a,a}.call(t,n,t,e),!(void 0!==o&&(e.exports=o))}])});