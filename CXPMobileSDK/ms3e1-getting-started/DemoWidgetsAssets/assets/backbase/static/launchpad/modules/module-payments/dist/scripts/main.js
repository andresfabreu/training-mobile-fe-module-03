!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("base"),require("core")):"function"==typeof define&&define.amd?define(["base","core"],t):"object"==typeof exports?exports["module-payments"]=t(require("base"),require("core")):e["module-payments"]=t(e.base,e.core)}(this,function(e,t){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var a;(function(e){a=function(require,e,t){"use strict";t.name="module-payments";var a=n(1),r=n(2),i=[r.name];t.exports=a.createModule(t.name,i).constant(n(3)).provider(n(4)).directive(n(5)).directive(n(6)).directive(n(7)).directive(n(8)).directive(n(9)).filter(n(10)).factory(n(11)).directive(n(12)).directive(n(13)).directive(n(14)).directive(n(15)).directive(n(16)).directive(n(17)).directive(n(18)).directive(n(19)).factory(n(20)).directive(n(21)).directive(n(22))}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))}).call(t,n(23)(e))},function(t,n,a){t.exports=e},function(e,n,a){e.exports=t},function(e,t,n){var a;a=function(require,e,t){"use strict";e.transferTypes={bank:"INTERNAL",p2pEmail:"P2P_EMAIL",p2pAddress:"P2P_ADDRESS",p2pMobile:"P2P_MOBILE"},e.pendingPaymentOrdersTimeout=1e4,e.customerId="3",e.currencyMaxLength=15}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var n=window.lp&&window.lp.util&&window.lp.util.generateUUID;e.lpPayments=function(){this.$get=function(e,t,a){function r(){var a=t(i.paymentsEndpoint,{},{getUnsubmitted:{method:"GET",url:i.paymentsEndpoint+"/:ids/unsubmitted",isArray:!0},create:{method:"PUT"},del:{method:"DELETE",url:i.paymentsEndpoint+"/:paymentId"},submit:{method:"POST",url:i.paymentsEndpoint+"/:paymentId/submit"}});return a.prototype.createOrder=function(t){var n=e.defer();return a.create({paymentId:t.id},t,function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise},a.prototype.send=function(t,n){var r=e.defer();return a.submit(t,n||{},function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},a.prototype.remove=function(t){var n=e.defer();return a.del({paymentId:t},{},function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise},a.prototype.createModel=function(){return new a({id:n()})},a.prototype.load=function(t){var n=e.defer(),r=this,i=[],o={f:0,l:100,ids:t.join(",")};return a.getUnsubmitted(o,function(e){i=e,r.pendingOrdersGroups=r.preprocessPendingOrdersGroups(i),n.resolve(r.pendingOrdersGroups)},function(e){}),n.promise},a.prototype.preprocessPendingOrdersGroups=function(e){for(var t,n=[],a=function(e){for(var t=!1,a=0;a<n.length;a++)n[a]["@id"]===e&&(t=!0);return t},r=function(e){n.push({"@id":e,paymentOrders:[]})},i=function(e){a(e.accountId)||r(e.accountId);for(var t=0;t<n.length;t++)n[t]["@id"]===e.accountId&&n[t].paymentOrders.push(e)},o=0;o<e.length;o++)t=e[o],t.counterpartyIban&&t.counterpartyIban.length>0?t.accountDetails=t.counterpartyIban:t.counterpartyAccount&&t.counterpartyAccount.length>0?t.accountDetails=t.counterpartyAccount:t.counterpartyEmail&&t.counterpartyEmail.length>0&&(t.accountDetails=t.counterpartyEmail),i(t);return n},a.prototype.makeFormObject=function(e){var t={update:!0,uuid:e.id,accountId:e.accountId,isScheduledTransfer:e.scheduledTransfer.every?!0:!1,scheduleDate:e.onDate?new Date(e.onDate):new Date,scheduledTransfer:{frequency:e.scheduledTransfer.frequency,every:e.scheduledTransfer.every,intervals:e.scheduledTransfer.intervals?[e.schedule.intervals]:[],timesToRepeat:e.scheduledTransfer.timesToRepeat||1,customOrder:e.scheduledTransfer.customOrder||!0,startDate:e.scheduledTransfer.startDate?new Date(e.scheduledTransfer.startDate):new Date},selectedCounter:{name:e.counterpartyName,account:e.counterpartyIban||e.counterpartyEmail},instructedCurrency:e.instructedCurrency,counterpartyName:e.counterpartyName,counterpartyAccount:e.counterpartyAccount,counterpartyIban:e.counterpartyIban||"",counterpartyEmail:e.counterpartyEmail,instructedAmount:e.instructedAmount.toFixed(2),paymentReference:e.paymentReference||"",paymentDescription:e.paymentDescription||"",counterpartyAddress:e.counterpartyAddress||"",isOpenDate:e.isOpenDate||!1,urgentTransfer:e.urgentTransfer||!1,type:e.type};return t},new a}var i={paymentsEndpoint:"/mock/v1/payments"};return{setConfig:function(e){return i=a(e).chain().mapValues(a.resolvePortalPlaceholders).defaults(i).value(),this},getConfig:function(e){return e&&a.isString(e)?i[e]:i},api:r}},this.$get.$inject=["$q","$resource","lpCoreUtils"]},e.PaymentOrderModel=e.lpPayments}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";e.addressTransfer=function(e,t){return e.put("$addressTransferTemplate.html",'<div class="lp-address-transfer"><div class="col-xs-12"><input type="input" class="form-control" ng-model="address.addressOne" placeholder="Address Line 1" aria-label="Address Line One" /><input type="input" class="form-control" ng-model="address.addressTwo" placeholder="Address Line 2" aria-label="Address Line Two"  /></div><div class="col-xs-12"><input type="input" class="form-control" ng-model="address.city" placeholder="City" aria-label="City" /></div><div class="col-xs-12"><div class="col-xs-5"><input type="input" class="form-control" ng-model="address.state" placeholder="State" aria-label="State" /></div><div ng-class="{\'col-xs-offset-1\': true, \'col-xs-6\': true, \'has-feedback\': address.zip.length > 0, \'has-error\': address.zip.length > 0 && !validZip, \'has-success\': address.zip.length > 0 && validZip}"><input type="input" class="form-control" ng-model="address.zip" placeholder="Zip" aria-label="Zip" /><span ng-if="validZip && address.zip.length > 0" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!validZip && address.zip.length > 0" ng-click="clear()" class="glyphicon glyphicon-remove form-control-feedback"></span></div></div><div class="warning"><span>Selecting this means a cheque will be printed and posted on your behalf. Can take 7-14 days.</span></div></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{counterpartyAddress:"=ngModel",transferType:"=lpTransferType"},template:e.get("$addressTransferTemplate.html"),link:function(e,n,a,r){var i=function(){e.address={addressOne:"",addressTwo:"",city:"",state:"",zip:""},d(e.transferType)},o=r[0],c=r[1],s=t.p2pAddress;o.$name=a.name,c.$addControl(o),o.$formatters.push(function(e){return l(e),e});var l=function(t){var n=!0,a=!0,r=!0,i=!0,c=!0;if(t){var s=t.split(", ");e.address.addressOne=s[0],e.address.addressTwo=s[1],e.address.city=s[2],e.address.state=s[3],e.address.zip=s[4],0===s[0].length&&(n=!1),0===s[2].length&&(a=!1),0===s[3].length&&(r=!1),0===s[4].length?i=!1:c=u(s[4])}o.$setValidity("addressLineOne",n),o.$setValidity("addressCity",a),o.$setValidity("addressState",r),o.$setValidity("addressZip",i),o.$setValidity("addressValidZip",c)},u=function(t){var n=/^\d{5}(-\d{4})?$/,a=n.test(t);return e.validZip=a,a};e.$watch("address",function(t,n){t!==n&&(e.counterpartyAddress=t.addressOne+", "+t.addressTwo+", "+t.city+", "+t.state+", "+t.zip)},!0),e.$watch("transferType",function(e,t){e!==t&&d(e)});var d=function(t){t===s?l(e.counterpartyAddress||""):(o.$setValidity("addressLineOne",!0),o.$setValidity("addressCity",!0),o.$setValidity("addressState",!0),o.$setValidity("addressZip",!0),o.$setValidity("addressValidZip",!0))};i()}}},e.addressTransfer.$inject=["$templateCache","transferTypes"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var a=window.jQuery,r=n(1).ng,i=window.lp&&window.lp.util;e.counterPartyFilter=function(e,t,n,o,c){return e.put("$counterPartyFilter.html",'<div class="lp-counter-party-filter"><div class="input-group has-clear"><input class="name-field form-control" type="text" ng-model="counterpartyName" ng-click="showContactList()" ng-keydown="showContactList($event)" aria-label="Counterparty Name" /><span class="counterparty-to text-muted">To:</span><span class="input-clear" ng-click="clearCounterParty()" ng-show="counterpartyName.length"><i class="glyphicon glyphicon-remove cursor-pointer"></i></span><span class="input-group-btn"><button type="button" role="button" aria-label="Auto Suggest" tabindex="0" class="btn btn-default dropdown-toggle" ng-click="toggleShowContacts()"><i class="lp-icon lp-icon-addressbook"></i></button></span></div><div class="dropdown"><ul ng-show="showContacts && (counterpartyList | filter:counterpartyName).length > 0" class="col-xs-12 dropdown-menu filter-list" style="display: block;"><li class="contact" ng-repeat="contact in counterpartyList | filter: counterpartyName | limitTo: 25 track by $index" ><div class="border" ng-class="{\'border-my-accounts\': contact.ownAccounts, \'border-other\': !contact.ownAccounts}"></div><div class="filter-contact clearfix" ng-class="{\'single-account-selection\': contact.accounts.length === 1}" ng-click="prepareSelection(contact)" ng-keydown="handleContactAccountToggleKeyDown(contact, $event)" dynamic-focus="contact"><div class="pull-left photo-container"><img class="contact-photo media-object" ng-src="{{getProfileImageByName(contact.photoUrl,contact.name)}}" /></div><div class="contact-info pull-left contact-details"><span class="contact-name">{{contact.name}}</span><p class="account-info" ng-if="contact.accounts.length > 1">{{contact.accounts.length}} account(s)</p><p class="account-info" ng-if="contact.accounts.length === 1">{{contact.accounts[0].account}}</p></div><div ng-if="contact.accounts.length > 1" class="pull-left contact-account-list"><p tabindex="0" class="toggle-accounts" ng-show="!contact.open" ng-click="toggleContactAccounts(contact)" ng-keydown="handleContactAccountToggleKeyDown(contact, $event)"  aria-label="View accounts for {{contact.name}}">View all accounts <span class="caret"></span></p><p tabindex="0" class="toggle-accounts" ng-show="contact.open" ng-click="toggleContactAccounts(contact)" ng-keydown="handleContactAccountToggleKeyDown(contact, $event)" aria-label="Close accounts for {{contact.name}}">Close all accounts <span class="caret"></span></p><div class="contact-accounts" ng-class="{\'contact-accounts-open\': contact.open}"><div tabindex="0" ng-show="contact.open" ng-repeat="account in contact.accounts track by $index" class="contact-single-account" ng-click="prepareSelection(contact, account)" ng-keydown="handleSingleAccountKeyDown(contact, account, $event)" dynamic-aria-label="dynamic-aria-label" aria-contact="contact" aria-account="account"><div class="col-xs-10 col-xs-offset-2"><p ng-if="account.name">{{account.name}}</p><p>{{account.account}}</p></div></div></div></div></div></li></ul></div></div>'),{restrict:"A",scope:{counterpartyName:"=ngModel",contacts:"=lpContacts",accounts:"=lpAccounts",onSelect:"="},require:["ngModel","^form"],template:e.get("$counterPartyFilter.html"),link:function(e,s,l,u){var d=u[0],p=u[1];d.$name=l.name,p.$addControl(d);var f=r.element(s.find("input")),m=s.get(0),g={up:38,down:40,enter:13},y={email:t.p2pEmail,account:t.bank},h=function(){e.counterpartyList=[],e.showContacts=!1,o.getData().success(function(t){e.profile=o.formatResponse(t,e.messages),e.deregisterContactsWatch=e.$watch("contacts",function(t){t.length>0&&(v(e.contacts),e.deregisterContactsWatch())}),e.deregisterAccountsWatch=e.$watch("contacts",function(t){t.length>0&&(b(e.accounts),e.deregisterAccountsWatch())})}),e.accountsConfigured=!1,e.contactsConfigured=!1};d.$formatters.push(function(e){return e.length>0?d.$setValidity("required",!0):d.$setValidity("required",!1),e}),d.$parsers.push(function(e){return e.length>0?d.$setValidity("required",!0):d.$setValidity("required",!1),e});var v=function(t){for(var n,a=0;a<t.length;a++){n=t[a],n.open=!1,n.accounts=[];for(var r in n)n.hasOwnProperty(r)&&y[r]&&n[r]&&n.accounts.push({type:y[r],account:n[r]});e.counterpartyList.push(n)}},b=function(n){var a={};a.name=e.profile.fullname,a.open=!1,a.ownAccounts=!0,a.accounts=[];for(var r=0;r<n.length;r++)a.accounts.push({type:t.bank,account:n[r].identifier,name:n[r].alias});e.counterpartyList.unshift(a)},w=function(){n.bind("click",function(t){m.contains(t.target)||(e.$apply(function(){e.showContacts=!1}),T())})},T=function(){n.unbind("click")},C=function(){return a(s.find(".contact")[0])},$=function(e){var t;e=r.element(event.target),e.next().hasClass("toggle-accounts")?t=e.next():e.prev().hasClass("toggle-accounts")&&(t=e.prev()),t&&setTimeout(function(){t.focus()},0)},O=function(e){return e.find(".toggle-accounts")},A=function(e){var t;t="block"===a(e[0]).css("display")?e[0]:e[1],t&&setTimeout(function(){t.focus()},0)},D=function(e){return e.parents(".contact")};e.toggleShowContacts=function(){e.showContacts=!e.showContacts,e.showContacts?w():T()},e.clearCounterParty=function(){e.counterpartyName="",e.showContacts=!0,w(),e.onSelect(),s.find(f)[0].focus()},e.$on("reset",function(){e.showContacts=!1}),e.showContactList=function(t){if(T(),!t||t.which===g.enter||t.which===g.down||t.which===g.up)if(t&&(t.preventDefault(),t.stopPropagation()),w(),e.showContacts)if(t&&t.which===g.down){var n=C(),a=O(n);a.length>0?A(a):n.find(".filter-contact").focus()}else!t||t.which!==g.up&&t.which!==g.enter||(e.showContacts=!1,T());else e.showContacts=!0},e.toggleContactAccounts=function(t){for(var n=0;n<e.counterpartyList.length;n++)e.counterpartyList[n].open=e.counterpartyList[n]===t?!e.counterpartyList[n].open:!1},e.handleContactAccountToggleKeyDown=function(t,n){n.preventDefault(),n.stopPropagation(),n.which===g.enter?1===t.accounts.length?e.prepareSelection(t):(e.toggleContactAccounts(t),$(n.target)):(n.which===g.down||n.which===g.up)&&e.keyToNextAccountToggle(n)},e.handleSingleAccountKeyDown=function(t,n,a){a.preventDefault(),a.stopPropagation(),a.which===g.enter?e.prepareSelection(t,n):(a.which===g.down||a.which===g.up)&&e.keyToNextAccount(a)},e.keyToNextAccountToggle=function(e){var t,n=a(e.target),r=D(n);if(e.which===g.down)if(n.next("div").length>0)r.find(".contact-single-account")[0].focus();else{var i=r.next(".contact");t=O(i),t.length>0?A(t):i.find(".filter-contact").focus()}else if(e.which===g.up){var o=r.prev(".contact");t=O(o),t.length>0?A(t):o.find(".filter-contact").length>0?o.find(".filter-contact").focus():f.focus()}},e.keyToNextAccount=function(e){var t,n,r,i=a(e.target);e.which===g.down?1===i.next(".contact-single-account").length&&(t=i.next(".contact-single-account")):e.which===g.up&&(1===i.prev(".contact-single-account").length?t=i.prev(".contact-single-account"):(n=D(i),r=O(n),r.length>0&&A(r))),t&&setTimeout(function(){t.trigger("focus")},0)},e.prepareSelection=function(t,n){if(!n){if(t.accounts.length>1)return;n=t.accounts[0]}e.showContacts=!1,T(),d.$setViewValue(t.name),e.onSelect(n),setTimeout(function(){f.focus()},0)},e.getProfileImageByName=function(e,t){return e?i.decodePhotoUrl(e):t?i.getDefaultProfileImage(t,100,100):(c.throwException("Expected a name but got "+t),"")},h()}}},e.counterPartyFilter.$inject=["$templateCache","transferTypes","$document","ProfileDetailsService","lpCoreError"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";e.dynamicAriaLabel=function(){return{restrict:"A",scope:{contact:"=ariaContact",account:"=ariaAccount"},link:function(e,t){var n="";if(n+=e.contact.name+" ",e.account.name)n+=e.account.name+" ";else{var a=e.account.type.toLowerCase();a=a.replace("_"," "),n+=a+" "}n+=e.account.account,t.attr("aria-label",n)}}}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";e.dynamicFocus=function(){return{restrict:"A",scope:{contact:"=dynamicFocus"},link:function(e,t){1===e.contact.accounts.length&&(t.attr("tabindex","0"),t.attr("aria-label",e.contact.name+" "+e.contact.accounts[0].type.toLowerCase()+" "+e.contact.accounts[0].account))}}}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var a=n(1).ng,r=window.lp&&window.lp.util;e.emailTransfer=function(e,t){return e.put("$emailTransferTemplate.html","<div class=\"lp-email-transfer\"><div ng-class=\"{'email-input': true, 'has-feedback': email.length > 0, 'has-success': email.length > 0 && validEmail, 'has-error': email.length > 0 && !validEmail}\">"+'<input type="input" ng-model="email" ng-keyup="handleAutoSuggest($event)" placeholder="Email address" class="form-control" aria-label="Email Address" /><span ng-if="validEmail && email.length > 0" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!validEmail && email.length > 0" ng-click="clear()" style="cursor: pointer;" class="glyphicon glyphicon-remove form-control-feedback"></span></div><span ng-if="autoSuggestActive">Did you mean <span ng-click="doAutoSuggest()" class="auto-correct-suggestion">{{autoSuggestion}}</span>?<br /></span><span class="text-muted" style="font-size: 13px;">Transfers up to $10.00 will be free of charge. For transfers above $10.00 a fee of $0.25 per transaction will be charged and debited from your account</span></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{email:"=ngModel",transferType:"=lpTransferType"},template:e.get("$emailTransferTemplate.html"),link:function(e,n,i,o){var c,s=function(){e.validEmail=!1,e.autoSuggestActive=!1,e.autoSuggestion="",c=a.element(n.find("input")[0]);var t={gmail:"gmail",yahoo:"yahoo",backbase:"backbase"};e.suggestionsMap={gmaik:t.gmail,gmain:t.gmail,gmal:t.gmail,gmakl:t.gmail,mgail:t.gmail,yaho:t.yahoo,yahooo:t.yahoo,yagoo:t.yahoo,bakbase:t.backbase,backbas:t.backbase,baclbase:t.backbase}},l=o[0],u=o[1],d=t.p2pEmail;l.$name=i.name,u.$addControl(l),l.$formatters.push(function(t){return(void 0!==t||null!==t)&&(e.validEmail=p(t?t.toLowerCase():"")),t&&-1===t.indexOf("@")&&(e.autoSuggestActive=!1),t}),e.clear=function(){e.email=""},e.handleAutoSuggest=function(t){var n,a;190===t.which?e.email.indexOf("@")>-1&&(n=e.email.split("@"),n[1]&&""!==n[1]&&(a=f(n[1]),void 0!==e.suggestionsMap[a]&&(e.autoSuggestion=e.suggestionsMap[a],e.autoSuggestActive=!0))):"[object KeyboardEvent]"===t.originalEvent.toString()&&8===t.which&&e.email.indexOf("@")>-1&&(n=e.email.split("@"),n[1]&&""!==n[1]&&(a=f(n[1]),void 0===e.suggestionsMap[a]&&(e.autoSuggestion="",e.autoSuggestActive=!1)))},e.doAutoSuggest=function(){var t=e.email.split("@");if(t[1]){var n=f(t[1]);t[1]=t[1].replace(n,e.autoSuggestion),e.email=t.join("@"),e.autoSuggestActive=!1,e.autoSuggestion=""}};var p=function(t){if(0===t.length&&e.transferType===d)return l.$setValidity("emailRequired",!1),!1;if(e.transferType===d){l.$setValidity("emailRequired",!0);var n=r.isValidEmail(t);return l.$setValidity("validEmailRequired",n),n}},f=function(e){var t,n=e.indexOf(".");return t=n>-1?e.substring(0,n):e};e.$watch("transferType",function(t,n){t!==d?(l.$setValidity("emailRequired",!0),l.$setValidity("validEmailRequired",!0)):e.validEmail=p(e.email)}),s()}}},e.emailTransfer.$inject=["$templateCache","transferTypes"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";e.addSeperator=function(){var e=" ",t=function(t){return 4===t.length&&(t+=e),t};return function(n){if(n){n=n.split(e).join(""),n=n.toUpperCase();for(var a=n.match(/.{1,4}/g),r="",i=0;i<a.length;i++)i!==a.length-1&&(a[i]=t(a[i])),r+=a[i];return r}}},e.addSeperator=function(){var e=" ",t=function(t){return 4===t.length&&(t+=e),t};return function(n){if(n){n=n.split(e).join(""),n=n.toUpperCase();for(var a=n.match(/.{1,4}/g),r="",i=0;i<a.length;i++)i!==a.length-1&&(a[i]=t(a[i])),r+=a[i];return r}}}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var a=n(1).ng,r=window.lp&&window.lp.util;e.IbanModel=function(e){var t=function(t){this.enableCountrySearch=t.enableCountrySearch,this.countryListService=e.getInstance({endpoint:t.countryListEndpoint}),this.value="",this.valid=!1,this.countryList=[],this.selectedCountry={}};return t.prototype.loadCountryList=function(){var e=this,t=e.countryListService.read();return t.then(function(t){e.countryList=t.data},function(){e.error="countryListServiceError"}),t},t.prototype.getCountryCode=function(e){var t=this,n=null,r=e||t.value;if(r.match(/^[A-Za-z]{2}/g)){var i=r.substr(0,2);a.forEach(t.countryList,function(e){return e.country_code===i.toUpperCase()?(n=i,void(t.selectedCountry=e)):void 0})}return n},t.prototype.normalizeIban=function(e){return e&&(e=e.toUpperCase(),e=e.replace(/[\-\. ]/g,"")),e||""},t.prototype.validate=function(){if(this.value.length!==parseInt(this.selectedCountry.iban_length,10))return this.valid=!1,!1;var e=new RegExp(this.selectedCountry.iban_regex);return e.test(this.value)&&r.validateISO7064Checksum(this.value)?(this.valid=!0,!0):(this.valid=!1,!1)},{getInstance:function(e){return new t(e)}}},e.IbanModel.$inject=["httpService"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var n=function(e){var t=function(){e.wholeAmount="",e.decimalAmount="",e.amountInDomesticCurrency="0.00",e.fieldLength=6};t()};n.$inject=["$scope"],e.lpCurrencyAmountInput=function(e){return e.put("$currencyAmountTemplate.html",'<div class="lp-currency-amount-input"><div class="clearfix"><div class="select-area pull-left"><div class="currency-select" ng-hide="lpDisableCurrencySelection" dropdown-select="dropdown-select" empty-placeholder-text="EUR" ng-model="lpCurrencyList.selected" ng-options="val as val.currency_code group by val.group for val in lpCurrencyList.orderedCurrencies" ng-hide="lpCurrencyList.error" aria-required="true" aria-label="currency"></div></div><div class="amount-area pull-left""><input name="wholeAmountInput" type="number" lp-number-input="lp-number-input" lp-max-length="fieldLength" min="0" step="1" class="form-control whole-amount-input pull-left" ng-model="wholeAmount" placeholder="Amount" aria-required="true" aria-label="amount" /><div  class="pull-left decimal"><span class="decimal-point">.</span></div><input type="text" pattern="[0-9]" lp-number-input="lp-number-input" lp-max-length="2" min="0" step="1" class="form-control pull-left decimal-amount-input" ng-model="decimalAmount" placeholder="00"  aria-required="true" aria-label="decimal amount" /></div></div><div class="info"><div ng-hide="lpDisableCurrencySelection || lpCurrencyList.error || lpCurrencyList.selected === lpCurrencyList.defaultCurrency" class="info-message"><span class="text-muted">This transfer is {{amountInDomesticCurrency}} in {{lpCurrencyList.defaultCurrency.currency_code}}<i class="lp-icon lp-icon-xxl lp-icon-info-sign open-popup" ng-click="toggleExchangeRateModal()"></i></span></div></div></div>'),{restrict:"EA",scope:{amount:"=ngModel",lpCurrencyList:"=",lpPaymentOrder:"=",lpDisableCurrencySelection:"=",toggleExchangeRateModal:"=modal"},require:"ngModel",replace:!0,controller:n,template:e.get("$currencyAmountTemplate.html"),link:function(e,t,n,a){var r=t.find(".decimal-amount-input");a.$formatters.push(function(t){var n=c();if("0.00"!==t&&""!==t&&t!==n){var a=t.split(".");e.wholeAmount=parseInt(a[0],10),"00"!==a[1]&&(e.decimalAmount=a[1])}return t});var i=function(){var t=e.amount;t/=e.lpCurrencyList.selected.exchange_rate,t=s(t),e.amountInDomesticCurrency=t},o=function(){var t=c(),n=parseInt(e.wholeAmount,10);e.fieldLength&&n.toString().length>e.fieldLength?a.$setValidity("lpCurrencyMaxLength",!1):a.$setValidity("lpCurrencyMaxLength",!0),"0.00"===t?a.$setValidity("lpAmountRequired",!1):t.length>0&&a.$setValidity("lpAmountRequired",!0),e.amount=t,e.lpCurrencyList.orderedCurrencies.length>0&&i()},c=function(){var t=e.decimalAmount,n=parseInt(e.wholeAmount,10),a=/^0[0-9].*$/;n=isNaN(n)?0:n,10>t&&!a.test(t)&&(t="0"+t),t=parseFloat("0."+t);var r=0===t?n:n+t;return r=s(r)},s=function(e){return e.toFixed(2)},l=function(){e.lpPaymentOrder.instructedCurrency=e.lpCurrencyList.selected.currency_code,u()},u=function(){var t=e.fieldLength;e.fieldLength=e.lpCurrencyList.selected.exchange_rate>2?8:6,t>e.fieldLength&&e.wholeAmount.toString().length>6?(e.wholeAmount=parseInt(e.wholeAmount.toString().substring(0,6),10),o()):(""!==e.wholeAmount||""!==e.decimalAmount)&&i()};e.$watchCollection("[wholeAmount, decimalAmount]",function(t){t[0]&&t[0].toString().indexOf(".")>-1&&(e.wholeAmount=parseInt(e.wholeAmount.toString().replace(".",""),10),r.focus()),o()}),e.$watch("lpCurrencyList.selected",function(){e.lpCurrencyList.selected&&e.lpCurrencyList.orderedCurrencies.length>1&&l()}),e.$on("reset",function(){e.wholeAmount="",e.decimalAmount="",e.amountInDomesticCurrency="0.00",e.fieldLength=6})}}},e.lpCurrencyAmountInput.$inject=["$templateCache"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";window.lp&&window.lp.util;e.lpFormatPaymentReference=function(e){return{restrict:"A",require:"ngModel",link:function(t,n,a,r){var i=function(t){if(t&&t.length>2){var n=t.substring(0,2);"RF"!==n&&(t="RF"+t)}var a=e("addSeperator")(t);return a!==t&&(r.$setViewValue(a),r.$render()),a};r.$parsers.push(i)}}},e.lpFormatPaymentReference.$inject=["$filter"];var n=function(e){var t=function(){e.paymentReference="",e.paymentDescription="",e.showInfoMessage=!1,e.paymentRefDisabled=!1,e.paymentDescDisabled=!1};t()};n.$inject=["$scope"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";e.lpFormatUsAccount=function(e){return{restrict:"A",require:"ngModel",link:function(t,n,a,r){var i=function(t){var n=e("addSeperator")(t);return n!==t&&(r.$setViewValue(n),r.$render()),n};r.$parsers.push(i)}}},e.lpFormatUsAccount.$inject=["$filter"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var a=window.jQuery,r=(n(1).ng,window.lp&&window.lp.util);e.lpIbanInput=function(e,t,n,i){return e.put("$ibanCountryOptionTemplate.html",'<span aria-label="{{option.country_name}}">{{option.country_code}}<span class="country-name"> - {{option.country_name}}</span></span>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{ibanModel:"=lpCountryList",transferType:"=lpTransferType"},template:'<div><div class="lp-iban"><div class="lp-iban-country-dropdown"><div dropdown-select="dropdown-select" empty-placeholder-text="NL" name="ibaneDropdownField" ng-model="iban.selectedCountry" ng-options="country.country_code as country for country in ibanModel.countryList" filter="ibanModel.enableCountrySearch" filter-placeholder-text="Search country" ng-change="change()" option-template-url="$ibanCountryOptionTemplate.html" aria-label="iban country code"></div></div><div class="lp-iban-input" ng-class="{\'has-success\': ibanModel.valid && iban.value.length, \'has-error\': !ibanModel.valid && iban.value.length,  \'has-feedback\': iban.value.length}"><input name="ibanInputField" ng-required="transferType === \'BANK\'" type="input" class="form-control" lp-input-overflow="lp-input-overflow" ng-model="iban.value"  aria-required="true" ng-keydown="getSelection($event)" ng-keypress="getSelection($event)" ng-mousedown="getSelection($event)" ng-mouseup="getSelection($event)" ng-change="change()" tabindex="0" placeholder="Enter IBAN or Account Number" aria-label="Enter IBAN or Account Number"><span ng-if="ibanModel.valid && iban.value.length" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!ibanModel.valid && iban.value.length" ng-click="clear()" class="glyphicon glyphicon-remove form-control-feedback"></span></div></div><span class="text-muted">{{testiban}}</span></div>',link:function(e,n,i,o){var c=o[0],s=o[1],l=n.find("input")[0],u=[],d=!1,p=0,f=a(n[0]),m="BANK";f.find('div[name="ibaneDropdownField"]').on("keypress",function(e){13===e.which&&t(function(){f.find('input[type="search"]').focus()})}),e.iban={},c.$name=i.name,s.$addControl(c),e.$watch("ibanModel.countryList",function(t){e.change(!0),e.ibanModel.countryList.length&&!e.iban.selectedCountry&&(e.iban.selectedCountry=e.ibanModel.countryList[0].country_code)}),c.$formatters.push(function(t){e.ibanModel.value=t,e.iban.value=h(t);var n=e.ibanModel.getCountryCode();e.ibanModel.validate(),n&&e.change(!0);var a=n?e.ibanModel.valid:!1;return c.$setValidity("validIban",a),t}),c.$parsers.push(function(t){var n=e.ibanModel.getCountryCode()?e.ibanModel.validate():!1;return y(t),n?t:void 0});var g=a(document.createElement("span"));g.addClass("lp-input-cursor-position-offset"),g.css("font-size",n.css("font-size")),a(l).after(g);var y=function(t){if(t!==m)c.$setValidity("validIban",!0),c.$setValidity("required",!0);else{var n=e.ibanModel.getCountryCode()?e.ibanModel.validate():!1;c.$setValidity("validIban",n)}},h=function(e){var t=[];for(t.push(e.substr(0,2)),e=e.substr(2);e.length>0;)t.push(e.substr(0,4)),e=e.substr(4);return t.join("-")};e.setCursorPosition=function(){var n=r.getNewCaretPosition(l,u,p,d);if(d=!1,n>2&&(n++,n>6)){var a=(n-3)/4;parseInt(a,10)===a&&n--,n+=parseInt(a,10)}t(function(){r.setCaretPositionOfInput(l,n,e.paymentReference,g)},20,!1)},e.getSelection=function(e){var t=function(e){var t=0,n=e;return n>2&&(n-=3,t++),t+=parseInt(n/5,10),e-t};u=r.getSelectionPositionOfInput(l,t),"[object KeyboardEvent]"===e.originalEvent.toString()&&8===e.originalEvent.which&&l.value.length&&(d=!0)},e.clear=function(){e.iban.value="",l.focus()},e.change=function(r){if(e.ibanModel.value!==e.ibanModel.normalizeIban(e.iban.selectedCountry+e.iban.value)){var i=e.ibanModel.normalizeIban(e.iban.value);e.ibanModel.getCountryCode(i)||(i=e.iban.selectedCountry+i),p=i.length-e.ibanModel.value.length,e.ibanModel.value=i,c.$setViewValue(i)}var o=e.ibanModel.getCountryCode();o&&(o!==e.iban.selectedCountry&&(e.iban.selectedCountry=o,a(n.find("button")[0]).addClass("lp-country-dropdown-update"),t(function(){a(n.find("button")[0]).removeClass("lp-country-dropdown-update")},200,!1)),e.iban.value=e.ibanModel.value.substr(2)),e.iban.value=h(e.ibanModel.normalizeIban(e.iban.value)),r||e.setCursorPosition()},e.$watch("transferType",function(e,t){y(e)}),y(e.transferType)}}},e.lpIbanInput.$inject=["$templateCache","$timeout","IbanModel","widget"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";e.lpInputCurrency=function(e){return{restrict:"A",require:"ngModel",link:function(t,n,a,r){var i=/^\d+((\.|\,)\d+)?$/,o=function(e,t,n){r.$setValidity("lpCurrencyFormat",e),e||(t=!0,n=!0),r.$setValidity("lpCurrencyNonZero",t),r.$setValidity("lpCurrencyMaxLength",n)};r.$parsers.unshift(function(t){return t?(t=t.replace(",","."),o(i.test(t),0!==parseFloat(t),t.length<e)):o(!0,!0,!0),t})}}},e.lpInputCurrency.$inject=["currencyMaxLength"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var n=window.lp&&window.lp.util;e.lpPaymentRefDescription=function(e,t,a){return e.put("$paymentRefDescription.html",'<div class="lp-payment-ref-description"><div ng-hide="hidePaymentReference" class="lp-payment-reference" ng-class="{\'has-success\': isValid && paymentReference.length > 0, \'has-error\': !isValid && paymentReference.length > 0,  \'has-feedback\': paymentReference.length}"><input  class="form-control" aria-label="payment reference" lp-payment-reference-field" type="text" placeholder="Payment reference (optional)" maxlength="31" ng-model="paymentReference" ng-disabled="paymentRefDisabled" lp-input-overflow="lp-input-overflow" ng-keydown="getSelection($event)" ng-keypress="getSelection($event)" ng-mousedown="getSelection($event)" ng-mouseup="getSelection($event)" lp-format-payment-reference="lp-format-payment-reference" /><span ng-if="isValid && paymentReference.length" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-click="clearRef()" ng-if="!isValid && paymentReference.length" class="glyphicon glyphicon-remove form-control-feedback"></span><div class="lp-input-dividers clearfix"><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div></div></div><div class="lp-payment-description"><textarea aria-label="payment description" class="form-control lp-payment-description-area" placeholder="Description (optional) Maximum number of characters is 140" maxlength="140" ng-model="paymentDescription" ng-disabled="paymentDescDisabled"></textarea></div><div ng-if="!hidePaymentReference" class="hover-catcher" ng-class="{refDisabled: paymentRefDisabled, descDisabled: paymentDescDisabled}" tooltip-placement="top" tooltip="You can only provide a Payment Reference or a Payment Description, not both."></div></div>'),
{restrict:"AE",replace:!0,require:["ngModel","^form"],scope:{paymentOrder:"=ngModel",hidePaymentReference:"="},template:e.get("$paymentRefDescription.html"),link:function(e,r,i,o){var c=o[0],s=o[1],l=r.find("input"),u=(r.find(".hover-catcher"),r.find("textarea"),l[0]),d=[],p=!1,f=0;c.$name=i.name;var m=$(document.createElement("span"));m.addClass("lp-input-cursor-position-offset"),m.css("font-size",r.css("font-size")),$(u).after(m),""!==e.paymentOrder.paymentReference?(e.paymentReference=a("addSeperator")(e.paymentOrder.paymentReference),e.paymentDescDisabled=!0):""!==e.paymentOrder.paymentDescription&&(e.paymentDescription=e.paymentOrder.paymentDescription,e.paymentRefDisabled=!0),e.hidePaymentReference&&(e.paymentDescDisabled=!1);var g=function(e){return e.split(" ").join("")},y=function(e){var t=!0;return e.length>25&&(t=!1),e.match(/^RF\d{2}/)||(t=!1),n.validateISO7064Checksum(e)||(t=!1),t};e.toggleInfoMessage=function(){e.showInfoMessage=!e.showInfoMessage},e.setCursorPosition=function(){var a=n.getNewCaretPosition(u,d,f,p);if(p=!1,a>4){var r=a/4;parseInt(r,10)===r&&a--,a+=parseInt(r,10)}t(function(){n.setCaretPositionOfInput(u,a,e.paymentReference,m)},20,!1)},e.getSelection=function(e){var t=function(e){var t=0;return t+=parseInt(e/5,10),e-t};d=n.getSelectionPositionOfInput(u,t),"[object KeyboardEvent]"===e.originalEvent.toString()&&8===e.originalEvent.which&&u.value.length&&(p=!0)},e.clearRef=function(){e.paymentReference="",u.focus()},e.$watch("paymentReference",function(t,n){if(n!==t){if(n||(n=""),t){if(t.length>0){s[c.$name]||s.$addControl(c);var a=g(t);e.isValid=y(a),c.$setValidity("validRef",e.isValid),f=n?a.length-g(n).length:a.length,e.paymentDescDisabled=!0,c.$modelValue.paymentReference=a}}else c.$modelValue.paymentReference="",e.paymentDescDisabled=!1,s.$removeControl(c);e.setCursorPosition()}},!0),e.$watch("paymentDescription",function(t,n){n!==t&&(t?t.length>0&&(e.paymentRefDisabled=!0,c.$modelValue.paymentDescription=t):(e.paymentRefDisabled=!1,c.$modelValue.paymentDescription=""))},!0),e.$on("reset",function(){e.paymentReference="",e.paymentDescription="",e.showInfoMessage=!1,e.paymentRefDisabled=!1,e.paymentDescDisabled=!1})}}},e.lpPaymentRefDescription.$inject=["$templateCache","$timeout","$filter"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";e.nonZero=function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){a.$parsers.unshift(function(e){return a.$setValidity("nonZero",0!==parseInt(e,10)),e})}}}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var n=window.lp&&window.lp.util;e.p2pEnrollment=function(e,t){return e.put("$emailTemplate.html",'<div class="lp-p2p-enrollment"><p class="warning">We also need a few details from you to make the transfer</p><div lp-accounts-select="lp-accounts-select" designated-class="lp-normal-account-select-size" ng-model="p2pRegistration.p2pAccount" lp-accounts="accounts" name="p2pAccountSelect" ng-change="onP2PAccountChange()"></div><ul tabset="tabset" class="nav-tabs"><li tab="tab"><span tab-heading="tab-heading" class="tab-heading">Email</span><div ng-class="{\'email-input-form\': true, \'has-feedback\': enrollment.email.length > 0, \'has-success\': enrollment.email.length > 0 && validEmail, \'has-error\': enrollment.email.length > 0 && !validEmail}"><input type="input" class="form-control" ng-model="enrollment.email" placeholder="Confirm your email" ng-change="onEmailChange()" aria-label="Email Address"/><span ng-if="validEmail && enrollment.email.length > 0" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!validEmail && enrollment.email.length > 0" ng-click="clearEmail()" style="cursor: pointer;" class="glyphicon glyphicon-remove form-control-feedback"></span></div></li></ul><div class="ts-and-cs" class="clearfix"><div class="pull-left ts-cs-check"><input type="checkbox" ng-model="p2pRegistration.userAgrees" ng-change="onAgreementChange()" aria-label="Do you agree with terms and conditions?" /></div><div class="pull-left ts-cs-details"><p>By registering this mobile number or email address, I agree that I am the email or mobile account holder, and I consent to receive email and automated text message about transfers at this time. Fees from carrier may apply</p></div></div></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{accounts:"=lpAccounts",enrollment:"=ngModel",transferType:"=lpTransferType"},template:e.get("$emailTemplate.html"),link:function(e,a,r,i){var o=i[0],c=i[1];o.$name=r.name,c.$addControl(o);var s=[t.p2pEmail,t.p2pMobile,t.p2pAddress],l=function(){e.p2pRegistration={p2pAccount:{},userAgrees:!1},d(e.transferType)};e.clearEmail=function(){e.enrollment.email=""},e.onP2PAccountChange=function(){e.enrollment.receivingAccountNumber=e.p2pRegistration.p2pAccount.identifier,o.$setValidity("p2pAccountRequired",!0)},e.onEmailChange=function(){u()},e.onAgreementChange=function(){o.$setValidity("termsAndConditions",e.p2pRegistration.userAgrees)},e.$watch("transferType",function(e,t){e!==t&&d(e)});var u=function(){var t;t=n.isValidEmail(e.enrollment?e.enrollment.email:""),o.$setValidity("validEmailRequired",t),e.validEmail=t},d=function(t){for(var n=!1,a=0;a<s.length;a++)t===s[a]&&(n=!0);n?(o.$setValidity("termsAndConditions",e.p2pRegistration.userAgrees),u(),o.$setValidity("p2pAccountRequired",!1)):(o.$setValidity("termsAndConditions",!0),o.$setValidity("validEmailRequired",!0),o.$setValidity("p2pAccountRequired",!0))};l()}}},e.p2pEnrollment.$inject=["$templateCache","transferTypes"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";window.lp&&window.lp.util;e.ScheduledDateCalculator=function(e){var t=function(e){var t=this;t.frequencies=e.frequencies};return t.prototype.addWeeksToDate=function(t,n){return e.date(t).add(n,"weeks").toDate()},t.prototype.addMonthsToDate=function(t,n){return e.date(t).add(n,"months").toDate()},t.prototype.addYearsToDate=function(t,n){return e.date(t).add(n,"years").toDate()},t.prototype.getLastDayOfMonth=function(){return e.date().endOf("month").toDate()},t.prototype.getFirstDayOfMonth=function(){var t=e.date();return 1!==t.date()&&t.add(1,"month").startOf("month"),t.toDate()},t.prototype.getLastFridayOfMonth=function(){var t=e.date().endOf("month");return t.day()>=5?t.subtract(t.day()-5,"days"):t.subtract(t.day()+2,"days"),t.toDate()},t.prototype.getLastDayOfMonthPlusTime=function(t,n){return e.date(t).add(n-1,"month").endOf("month").toDate()},t.prototype.getFirstDayOfMonthPlusTime=function(t,n){var a=e.date(t).clone();return 0===a.day()?(a.add(n-1,"months").startOf("month"),t=a.isBefore(t)?a.add(1,"months"):a):t=e.date(t).add(n,"months").startOf("month"),t.toDate()},t.prototype.getLastFridayOfMonthPlusTime=function(t,n){var a=e.date(t).clone(),r=function(e){return e.subtract(1,"week").endOf("week").subtract(1,"days")};return 5!==a.endOf("month").day()?(r(a),a.isBefore(t)?a.add(n,"months"):a.add(n-1,"months"),5!==a.endOf("month").day()&&r(a)):(a.add(n-1,"months").endOf("month"),5!==a.day()&&r(a)),t=a.toDate(),t=a.toDate()},t.prototype.calculateMinimumEndDate=function(t,n,a){switch(t){case this.frequencies.WEEKLY:a=e.date(a).add(1*n,"weeks").toDate();break;case this.frequencies.MONTHLY:a=e.date(a).add(1*n,"months").toDate();break;case this.frequencies.YEARLY:a=e.date(a).add(1*n,"years").toDate();break;case this.frequencies.LAST_FRIDAY_OF_THE_MONTH:a=this.getLastFridayOfMonthPlusTime(a,1);break;case this.frequencies.START_OF_THE_MONTH:a=this.getFirstDayOfMonthPlusTime(a,1);break;case this.frequencies.END_OF_THE_MONTH:a=this.getLastDayOfMonthPlusTime(a,1)}return a},{getInstance:function(e){return new t(e)}}},e.ScheduledDateCalculator.$inject=["lpCoreUtils"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var n=window.lp&&window.lp.util;e.scheduledTransfer=function(e,t){var a=n.baseUrlResolvedFromWidgetUrl(t)+"/modules/ui/templates/";return{restrict:"AE",replace:!0,require:["ngModel","^form"],templateUrl:a+"scheduled-transfer.html",link:function(t,n,a,r){var i,o=function(){t.todaysDate=new Date,t.minEndDate=new Date,t.frequenciesEnum={START_OF_THE_MONTH:"START_OF_THE_MONTH",END_OF_THE_MONTH:"END_OF_THE_MONTH",LAST_FRIDAY_OF_THE_MONTH:"LAST_FRIDAY_OF_THE_MONTH",WEEKLY:"WEEKLY",MONTHLY:"MONTHLY",YEARLY:"YEARLY"},i=e.getInstance({frequencies:t.frequenciesEnum}),t.frequencies||(t.frequencies=[{id:t.frequenciesEnum.START_OF_THE_MONTH,value:"First of the month",group:"apreset"},{id:t.frequenciesEnum.END_OF_THE_MONTH,value:"End of the month",group:"apreset"},{id:t.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH,value:"Last Friday of the month",group:"apreset"},{id:t.frequenciesEnum.WEEKLY,value:"Weekly",group:"bcustom"},{id:t.frequenciesEnum.MONTHLY,value:"Monthly",group:"bcustom"},{id:t.frequenciesEnum.YEARLY,value:"Yearly",group:"bcustom"}]),t.days=[{id:1,value:"M",label:"Monday",active:!1},{id:2,value:"T",label:"Tuesday",active:!1},{id:3,value:"W",label:"Wednesday",active:!1},{id:4,value:"T",label:"Thursday",active:!1},{id:5,value:"F",label:"Friday",active:!1},{id:6,value:"S",label:"Saturday",active:!1},{id:7,value:"S",label:"Sunday",active:!1}],t.months=[{id:1,value:"Jan",label:"January",active:!1},{id:2,value:"Feb",label:"February",active:!1},{id:3,value:"Mar",label:"March",active:!1},{id:4,value:"Apr",label:"April",active:!1},{id:5,value:"May",label:"May",active:!1},{id:6,value:"Jun",label:"June",active:!1},{id:7,value:"Jul",label:"July",active:!1},{id:8,value:"Aug",label:"August",active:!1},{id:9,value:"Sep",label:"September",active:!1},{id:10,value:"Oct",label:"October",active:!1},{id:11,value:"Nov",label:"November",active:!1},{id:12,value:"Dec",label:"December",active:!1}],t.dates=[];for(var n=1;32>n;n++)t.dates.push({id:n,value:n,label:n,active:!1});t.endOptions||(t.endOptions=[{id:"after",value:"After"},{id:"onDate",value:"On date"}]),t.paymentOrder.scheduledTransfer.endOn=t.endOptions[0].id,t.customOrder=!1,t.dateWarning=!1,t.calendar={startCalendarOpen:!1,endCalendarOpen:!1},t.endDateOptions={datepickerMode:"year","show-weeks":!1},t.startDateOptions={"show-weeks":!1},t.timesEndDate=t.paymentOrder.scheduledTransfer.endDate,t.setEndDate()},c=r[0],s=r[1];c.$name="scheduledTransfer",s.$addControl(c),c.$formatters.push(function(e){if(e.intervals.length>0){var n,a;if(e.frequency===t.frequenciesEnum.WEEKLY){for(n=0;n<e.intervals.length;n++)for(a=0;a<t.days.length;a++)if(e.intervals[n]===t.days[a].id){t.days[a].active=!0;break}}else if(e.frequency===t.frequenciesEnum.MONTHLY){for(n=0;n<e.intervals.length;n++)for(a=0;a<t.dates.length;a++)if(e.intervals[n]===t.dates[a].id){t.dates[a].active=!0;break}}else if(e.frequency===t.frequenciesEnum.YEARLY)for(n=0;n<e.intervals.length;n++)for(a=0;a<t.months.length;a++)if(e.intervals[n]===t.months[a].id){t.months[a].active=!0;break}}t.paymentOrder.scheduledTransfer.frequency=""===e.frequency?t.frequencies[0].id:e.frequency,t.customOrder=p()?!0:!1,d(),t.setTransferPeriodDates()}),t.frequencyChanged=function(){u(),t.setTransferPeriodDates(),p()?(t.customOrder=!0,l(),t.paymentOrder.scheduledTransfer.customOrder=!0):(t.customOrder=!1,c.$setValidity("intervalsRequired",!0),t.paymentOrder.scheduledTransfer.customOrder=!1),d()},t.toggleInterval=function(e){var n,a;if(t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.WEEKLY?n=t.days:t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY?n=t.dates:t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.YEARLY&&(n=t.months),a=n[e],a.active){var r=t.paymentOrder.scheduledTransfer.intervals.indexOf(a.id);t.paymentOrder.scheduledTransfer.intervals.splice(r,1)}else t.paymentOrder.scheduledTransfer.intervals.push(a.id);a.active=!a.active,l(),d(),t.setEndDate()};var l=function(){var e=!0;e=t.paymentOrder.scheduledTransfer.intervals.length>0?!0:!1,e=t.customOrder?e:!0,e=t.paymentOrder.isScheduledTransfer?e:!0,c.$setValidity("intervalsRequired",e)},u=function(){t.paymentOrder.scheduledTransfer.intervals=[];var e;for(e=0;e<t.days.length;e++)t.days[e].active=!1;for(e=0;e<t.dates.length;e++)t.dates[e].active=!1;for(e=0;e<t.months.length;e++)t.months[e].active=!1};t.openStartCalendar=function(e){("click"===e.type||32===e.which||13===e.which)&&(e.preventDefault(),e.stopPropagation(),t.calendar.endCalendarOpen=!1,t.calendar.startCalendarOpen=!t.calendar.startCalendarOpen)},t.openEndCalendar=function(e){("click"===e.type||32===e.which||13===e.which)&&(e.preventDefault(),e.stopPropagation(),t.calendar.startCalendarOpen=!1,t.calendar.endCalendarOpen=!t.calendar.endCalendarOpen)},t.setTransferPeriodDates=function(){"object"!=typeof t.paymentOrder.scheduledTransfer.startDate&&(p()?t.paymentOrder.scheduledTransfer.startDate=new Date(t.todaysDate.getTime()):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.END_OF_THE_MONTH?t.paymentOrder.scheduledTransfer.startDate=i.getLastDayOfMonth():t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.START_OF_THE_MONTH?t.paymentOrder.scheduledTransfer.startDate=i.getFirstDayOfMonth():t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH&&(t.paymentOrder.scheduledTransfer.startDate=i.getLastFridayOfMonth())),t.setEndDate()},t.setEndDate=function(){var e;if(t.paymentOrder.scheduledTransfer.startDate){var n=new Date(t.paymentOrder.scheduledTransfer.startDate.getTime());p()?(e=t.paymentOrder.scheduledTransfer.timesToRepeat*t.paymentOrder.scheduledTransfer.every,t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.WEEKLY?n=i.addWeeksToDate(n,e):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY?n=i.addMonthsToDate(n,e):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.YEARLY&&(n=i.addYearsToDate(n,e))):(e=t.paymentOrder.scheduledTransfer.timesToRepeat,e=t.paymentOrder.scheduledTransfer.timesToRepeat,t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.END_OF_THE_MONTH?n=i.getLastDayOfMonthPlusTime(n,e):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.START_OF_THE_MONTH?n=i.getFirstDayOfMonthPlusTime(n,e):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH&&(n=i.getLastFridayOfMonthPlusTime(n,e))),t.paymentOrder.scheduledTransfer.endDate=n,t.minEndDate=i.calculateMinimumEndDate(t.paymentOrder.scheduledTransfer.frequency,t.paymentOrder.scheduledTransfer.every,new Date(t.paymentOrder.scheduledTransfer.startDate.getTime())),t.timesEndDate=new Date(t.paymentOrder.scheduledTransfer.endDate.getTime()).toString("d-MMM-yyyy")}};var d=function(){var e=!1;if(t.paymentOrder.scheduledTransfer.intervals.length>0&&t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY)for(var n=28;31>n;n++)t.dates[n].active&&(e=!0);t.dateWarning=e};t.$watch("paymentOrder.isScheduledTransfer",function(e){l()}),t.$on("reset",function(){t.paymentOrder.scheduledTransfer.frequency=t.frequencies[0].id,t.customOrder=!1,t.paymentOrder.scheduledTransfer.customOrder=!1});var p=function(){return t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.WEEKLY||t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY||t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.YEARLY};o()}}},e.scheduledTransfer.$inject=["ScheduledDateCalculator","widget"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var n=window.jQuery,a=window.lp&&window.lp.util;e.usAccountInput=function(e,t,r,i){return e.put("$usTransferCountryDropdownOption.html",'<span aria-label="{{option.country_name}}">{{option.country_code}}<span class="country-name"> - {{option.country_name}}</span></span>'),e.put("$usAccountInputTemplate.html",'<div class="lp-us-account-input"><div ng-class="{\'has-success\': isRoutingNoValid && routingNumber.length > 0, \'has-error\': !isRoutingNoValid && routingNumber.length, \'has-feedback\': routingNumber.length}"><input type="input" class="form-control routing-number" ng-model="routingNumber" lp-number-input="lp-number-input" min="0" maxlength="9" placeholder="{{\'Routing Number\'|translate}}" aria-required="true" aria-label="{{\'Routing Number\'|translate}}" /><span ng-if="isRoutingNoValid && routingNumber.length" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-click="resetRoutingNumber()" ng-if="!isRoutingNoValid && routingNumber.length" class="glyphicon glyphicon-remove form-control-feedback clickable-icon"></span></div><div class="lp-acc-plus-country"><div class="country-select" ng-if="showCountryDropdown"><div dropdown-select="dropdown-select" class="country-select" empty-placeholder-text="US" ng-model="selectedCountry" ng-options="country.country_code as country for country in lpCountryList.countries" option-template-url="$usTransferCountryDropdownOption.html"></div></div><div ng-class="{\'has-success\': isAccNoConfirmed && accountNumber.length > 0, \'has-warning\': !isAccNoConfirmed && accountNumber.length, \'has-feedback\': accountNumber.length, \'account-number\': true}"><input type="input" class="form-control" ng-model="accountNumber" lp-number-input="lp-number-input" maxlength="19" min="0" placeholder="{{\'Account Number\'|translate}}" aria-required="true" aria-label="{{\'Account Number\'|translate}}"ng-keydown="getSelection($event)" ng-keypress="getSelection($event)" ng-mousedown="getSelection($event)" ng-mouseup="getSelection($event)"lp-input-overflow="lp-input-overflow" lp-format-us-account="lp-format-us-account"/><span ng-if="isAccNoConfirmed && accountNumber.length" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-click="confirmAccountNumber()" ng-keydown="confirmKeydown($event)" tabindex="{{!isAccNoConfirmed && accountNumber.length ? 0 : -1}}" ng-if="!isAccNoConfirmed && accountNumber.length" class="glyphicon glyphicon-warning-sign form-control-feedback clickable-icon" aria-label="Confirm Account Number" role="button"></span><div class="lp-input-dividers clearfix" style="top: 28px;"><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div></div></div></div><span class="lp-routing-info text-muted"><span lp-i18n="Where to find your account number & routing number"></span><i class="lp-icon lp-icon-xxl lp-icon-info-sign open-popup" ng-click="modal()"></i></span></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{account:"=ngModel",lpCountryList:"=",modal:"=",transferType:"=lpTransferType"},template:e.get("$usAccountInputTemplate.html"),link:function(e,o,c,s){var l=function(){e.isAccNoConfirmed=!1,e.isRoutingNoValid=!1,e.showCountryDropdown=e.lpCountryList?!0:!1,e.showCountryDropdown&&e.lpCountryList.default_country&&(e.selectedCountry=e.lpCountryList.default_country.country_code),$(e.transferType||"")},u=s[0],d=s[1];u.$name=c.name,d.$addControl(u),u.$setValidity("accountNumberRequired",!1),u.$setValidity("routingNumberRequired",!1);var p=o.find("input")[1],f=[],m=!1,g=0,y=i.bank,h=n(document.createElement("span"));h.addClass("lp-input-cursor-position-offset"),h.css("font-size",o.css("font-size")),n(p).after(h),u.$formatters.push(function(t){if(t)if(isNaN(parseInt(t.substring(0,2),10)))e.accountNumber="",e.routingNumber="";else{var n=t.split(" ");e.routingNumber=n[0],e.accountNumber=r("addSeperator")(n[1]),v(e.routingNumber),w(e.accountNumber)}else e.accountNumber="",e.routingNumber="";return t}),u.$parsers.push(function(e){var t=e.split(" ");return v(t[0]),w(t[1]),e}),e.confirmAccountNumber=function(){e.isAccNoConfirmed=!0,u.$setValidity("accountNumberConfirmed",!0)},e.confirmKeydown=function(t){13===t.which&&(t.stopPropagation(),t.preventDefault(),e.confirmAccountNumber(),o.find(".routing-number").focus())},e.resetRoutingNumber=function(){e.routingNumber=""},e.getSelection=function(e){var t=function(e){var t=0;return t+=parseInt(e/5,10),e-t};f=a.getSelectionPositionOfInput(p,t),"[object KeyboardEvent]"===e.originalEvent.toString()&&8===e.originalEvent.which&&p.value.length&&(m=!0)},e.setCursorPosition=function(){var n=a.getNewCaretPosition(p,f,g,m);if(m=!1,n>4){var r=n/4;parseInt(r,10)===r&&n--,n+=parseInt(r,10)}t(function(){a.setCaretPositionOfInput(p,n,e.paymentReference,h)},20,!1)},e.$watch("accountNumber",function(t,n){t!==n&&(e.isAccNoConfirmed=!1,C(),e.setCursorPosition())}),e.$watch("routingNumber",function(e,t){e!==t&&C()}),e.$watch("transferType",function(e,t){e!==t&&$(e)}),e.$on("reset",function(){e.routingNumber="",e.accountNumber=""});var v=function(t){if(t.length<9)return e.isRoutingNoValid=!1,void b(t);var n;if("000000000"===t)n=!1;else{var a=parseInt(t[0],10)+parseInt(t[3],10)+parseInt(t[6],10),r=parseInt(t[1],10)+parseInt(t[4],10)+parseInt(t[7],10),i=parseInt(t[2],10)+parseInt(t[5],10)+parseInt(t[8],10),o=3*a+7*r+i;n=o%10,n=0===n?!0:!1}e.isRoutingNoValid=n,b(t)},b=function(t){var n=t.length>0?!0:!1,a=n&&!e.isRoutingNoValid?!1:!0;u.$setValidity("routingNumberRequired",n),u.$setValidity("invalidRoutingNumber",a)},w=function(t){var n=t&&t.length>0?!0:!1,a=t&&t.length>0&&!e.isAccNoConfirmed?!1:!0;u.$setValidity("accountNumberRequired",n),u.$setValidity("accountNumberConfirmed",a)},T=function(e){return e&&(e=e.replace(/ /g,"")),e||""},C=function(){var t=T(e.routingNumber)+" "+T(e.accountNumber);u.$setViewValue(t)},$=function(t){t!==y?(u.$setValidity("accountNumberRequired",!0),u.$setValidity("accountNumberConfirmed",!0),u.$setValidity("routingNumberRequired",!0),u.$setValidity("invalidRoutingNumber",!0)):(v(e.routingNumber||""),w(e.accountNumber||""))};l()}}},e.usAccountInput.$inject=["$templateCache","$timeout","$filter","transferTypes"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}}])});