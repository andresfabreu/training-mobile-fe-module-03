!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("base"),require("core"),require("ui"),require("module-accounts"),require("module-payments")):"function"==typeof define&&define.amd?define(["base","core","ui","module-accounts","module-payments"],t):"object"==typeof exports?exports["module-ebilling"]=t(require("base"),require("core"),require("ui"),require("module-accounts"),require("module-payments")):e["module-ebilling"]=t(e.base,e.core,e.ui,e["module-accounts"],e["module-payments"])}(this,function(e,t,n,i,a){return function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var i;(function(e){i=function(require,e,t){"use strict";t.name="module-ebilling";var i=n(1),a=n(2),r=n(3),o=n(4),s=n(5),l=n(11),c=[r.name,a.name,o.name,s.name,l.name];t.exports=i.createModule(t.name,c).provider(n(6)).service(n(7).services).factory(n(7).factories).filter(n(8)).directive(n(9).directives).service(n(10))}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))}).call(t,n(12)(e))},function(t,n,i){t.exports=e},function(e,n,i){e.exports=t},function(e,t,i){e.exports=n},function(e,t,n){e.exports=i},function(e,t,n){e.exports=a},function(e,t,n){var i;i=function(require,e,t){"use strict";e.lpEbilling=function(){this.$get=function(e,t,n,i,a,r){var o={baseUrl:"",locale:"en",debitOrdersSrc:"",mandatesSrc:"",dateListFormat:"MMM dd",showCurrencySym:!0,templates:{},cache:{enable:!1}},s=a;return s.init(o.cache),{getAccounts:function(){var t=e.defer(),n=s.get("accounts");return n?t.resolve(n):(r.setConfig({accountsEndpoint:o.accountsEndPoint}),r.load().then(function(e){e?(s.put("accounts",e),t.resolve(e)):t.reject()},function(e){t.reject(e)})),t.promise},getTemplate:function(e){if(!o.templates[e])throw new Error("Unable to resolve template : "+e);var t=o.baseUrl+o.templates[e];return t},setConfig:function(e){return o=n(e).chain().mapValues(n.resolvePortalPlaceholders).defaults(o).value(),this},getConfig:function(e){return e&&n.isString(e)?o[e]:o}}},this.$get.$inject=["$q","$http","lpCoreUtils","lpEbillingUtils","lpEbillingCache","AccountsModel"]}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(require,e,t){"use strict";var n={},i={},a={};i.lpEbillingDebitOrdersModel=function(e,t,n,i,a,r,o){function s(e){var t=i.CURRENCY_MAP[e.currency]||"",n={id:e.id,status:e.status,currencySym:t,dueDate:e.paymentDueDate,dueDateFiltered:p(e.paymentDueDate,"MMM dd y"),scheduledDate:e.paymentScheduledDate,scheduledDateFiltered:p(e.paymentScheduledDate,"MMM dd"),statusReasonInformation:e.statusReasonInformation,isOverdue:c.checkDueDate("isPast",e.paymentDueDate)};return e.amount&&(n.amount=parseFloat(e.amount,10),n.amountFiltered=m(e.amount,t)),e.minimalAmount&&(n.minAmount=parseFloat(e.minimalAmount,10),n.minAmountFiltered=m(e.minimalAmount,t)),e.mandate&&(n.autoPay=e.mandate.directDebit,n.mandate=new f(e.mandate)),e.amountPaid&&(n.amountPaid=e.amountPaid,n.amountPaidFiltered=o("eBillCurrency")(n.amountPaid,t)),e.modifiedDate&&(n.modifiedDate=e.modifiedDate,n.modifiedDateFiltered=p(e.modifiedDate,"MMM dd")),e.debtor&&(n.debtor=e.debtor),e.actions&&e.actions instanceof Array&&(n.actions={},e.actions.map(function(e){n.actions[e]=l[e]})),n}var l,c=n,d=e.getConfig(),u=c.resolvePreference(d.debitOrdersSrc),p=o("date"),m=o("eBillCurrency"),f=t;return l=a(u+"/:id/:action",{},{query:{method:"GET",isArray:!0,cache:d.cache.enable,interceptor:{response:function(e){var t=e.data;return t instanceof Array&&t.length>0?t.map(s):t}}},accept:{params:{action:"accept"},method:"POST"},decline:{params:{action:"decline"},method:"POST"},pay:{params:{action:"pay"},method:"POST"},reject:{params:{action:"reject"},method:"POST"}}),l.getAll=function(e){return e=c.extend(e||{},{status:["SCHEDULED","RECEIVED","HANDLING"].join(",")}),this.query(e).$promise},l.getAllNew=function(e){return e=c.extend(e||{},{status:["IN_PROGRESS"].join(",")}),this.query(e).$promise},l.getHistory=function(e){return e=c.extend(e||{},{status:["PAID","REJECTED","REFUSED"].join(",")}),this.query(e).$promise},l},i.lpEbillingDebitOrdersModel.$inject=["lpEbilling","lpEbillingMandateModel","lpEbillingUtils","lpCoreI18nUtils","$resource","$q","$filter"],i.lpEbillingMandateModel=function(e,t,n){function i(e){var t={id:e.id,creditorName:e.creditor.name,creditorReference:e.creditor.reference,creditorAddress:e.creditor.postalAddress,debitorName:e.debtor.name,debitorAccount:e.debtor.account,notifyOnNewOrders:e.notifyOnNewOrders};return e.actions&&e.actions instanceof Array&&(t.actions={},e.actions.map(function(e){t.actions[e]=a[e]})),t}var a,r=t,o=e.getConfig(),s=r.resolvePreference(o.mandatesSrc);return a=n(s+"/:id/:action",{id:"@id"},{get:{method:"GET",isArray:!1,cache:o.cache.enable,interceptor:{response:function(e){return i(e.data)}}},enableDirectDebit:{method:"POST"},disableDirectDebit:{method:"POST"},enableNotifyOnNewOrders:{method:"POST"},disableNotifyOnNewOrders:{method:"POST"}})},i.lpEbillingMandateModel.$inject=["lpEbilling","lpEbillingUtils","$resource"],i.lpEbillingCache=function(e){var t,n;return{init:function(i){n=i,t=e("EBill.Cache",n)},put:function(e,i){return!!n.enable&&t.put(e,i)},remove:function(e){return t.remove(e)},removeAll:function(){return t.removeAll()},get:function(e){return t.get(e)},info:function(){return t.info()},template:function(){}}},i.lpEbillingCache.$inject=["$cacheFactory"],a.lpEbillingBus=function(e,t,n){var i=n,a=i.isObject(t.gadgets.pubsub)&&i.isFunction(t.gadgets.pubsub.publish);this.channels={},this.publish=function(n,r,o){i.info("%c"+n,"color: blue"),e.$emit(n,r),"boolean"==typeof o&&o&&a&&t.gadgets.pubsub.publish(n,r)},this.subscribe=function(n,i,r){this.channels[n]=e.$on(n,i),"boolean"==typeof r&&r&&a&&t.gadgets.pubsub.subscribe(n,i)},this.unsubscribe=function(e,n,i){return this.channels[e]&&this.channels[e](),"boolean"==typeof i&&i&&a&&t.gadgets.pubsub.unsubscribe(e,n),this}},a.lpEbillingBus.$inject=["$rootScope","$window","lpEbillingUtils"],e.providers=n,e.factories=i,e.services=a}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(require,e,t){"use strict";e.eBillCurrency=function(e,t){var n=e("currency"),i=t.getConfig(),a=i.showCurrencySym;return function(e,t){return t=a?t:"",n(e,t)}},e.eBillCurrency.$inject=["$filter","lpEbilling"]}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(require,e,t){"use strict";var n=window.jQuery,i={};i.eBillListItem=["$timeout","$compile","lpEbillingUtils",function(e,t,i){var a=["<div>",'<div class="list-view-container"','on-swipe="onSwipe($event)"','ng-click="onClick($event)"','ng-keypress="onKeyPressed($event)"','tabindex="0"',"ng-class=\"{'bill-overdue': bill.isOverdue}\"",'on-gesture-options="{ dragLockToAxisX: true,  dragBlockHorizontal: true }">','<div class="col-xs-7 e-bill-list-info column text-left">','<div class="centered">','<span class="sr-only">Name</span>','<div class="h4 counterparty-name"><strong>{{title}}</strong></div>','<div class="h6 text-muted">{{subtitle}}</div>',"</div>","</div>",'<div class="col-xs-5 e-bill-list-amount-wrapper column text-right">','<div class="centered">','<div class="e-bill-list-amount">','<span class="sr-only">Amount</span>','<span class="h4">{{amount}}</span>',"</div>",'<div class="e-bill-list-info-amount">','<span class="e-bill-auto-pay-stamp badge" ng-if="auto">Auto</span>','<span class="e-bill-list-due-date badge" ng-if="date">','<i class="glyphicon glyphicon-calendar"></i> {{date}}',"</span>","</div>","</div>","</div>",'<div class="toggle-list">',"<i class=\"lp-icon\" ng-class=\"{ 'lp-icon-angle-up' : bill.opened, 'lp-icon-angle-down': !bill.opened}\"></i>","</div>","</div>","<div ng-transclude></div>","</div>"].join(" "),r=function(e,t,i){var a=this;n(".list-view-container.swiped-out").css({left:0}).removeClass("swiped-out"),e.stop().animate({width:e.width()-t},0,function(){a.isSwiped=!0,"function"==typeof i&&i.call(null)}).addClass("swiped-out")},o=function(e,t){var n=this;e.stop().animate({width:"100%"},0,function(){n.isSwiped=!1,"function"==typeof t&&t.call(null)}).removeClass("swiped-out")},s=function(t,i,a,s){var l,c=i.find(".list-view-container");switch(t.isSwiped=!1,t.bill.opened=!1,"HANDLING"===t.bill.status&&(t.bill.processing=!0),t.title=t.bill.mandate.creditor.name,t.subtitle=t.bill.mandate.creditor.reference,t.amount=t.bill.amountFiltered,t.date=t.bill.scheduledDateFiltered,t.auto=t.bill.mandate.directDebit,a.eBillListItem){case"history":t.subtitle=t.bill.statusReasonInformation?t.bill.status+" - "+t.bill.statusReasonInformation:t.bill.status;break;case"newbills":t.subtitle=t.bill.mandate.creditor.reference}t.onKeyPressed=function(e){(13===e.keyCode||32===e.which)&&(t.onClick(e),e.preventDefault())},t.onClick=function(e){t.bill.opened=!t.bill.opened},t.onSwipe=function(n){var a=i.find(".list-view-container");l=i.find(".list-view-actions").width(),0>=+l||(t.bill.opened&&(t.bill.opened=!1),t.isSwiped&&n.srcEvent.stopPropagation(),e(function(){switch(n.direction){case 2:r.call(t,a,l);break;case 4:o.call(t,a,l)}},23))},t.$on("$destroy",function(){}),t.$watch("bill.opened",function(e){(t.isSwiped||t.isSwiped&&e)&&o.call(t,c)}),t.$watch("bill.autoPay",function(a){l=i.find(".list-view-actions").width(),e(function(){l=i.find(".list-view-actions").width(),t.isSwiped&&n(".list-view-container.swiped-out").css({left:-l})})})},l=function(){return s};return{restrict:"EA",require:"?ngModel",priority:Number.MAX_VALUE,transclude:!0,compile:l,template:a,scope:{bill:"=ngModel"}}}],i.eBillAmountInput=["$timeout",function(e){var t=['<div class="input-group clearfix">','<span class="input-group-addon" ng-bind="currencySym" ng-if="currencySym"></span>','<input name="noDecimal"  placeholder="0" lp-number-input lp-max-length="4" min="0" class="form-control whole-amount-input pull-left text-right" type="number" ng-model="noDecimal"/>','<div class="pull-left decimal"><span class="decimal-point">.</span></div>','<input name="decimal" lp-number-input type="number" ng-model="decimal" placeholder="0" lp-max-length="2" min="0" maxlength="2" max="99" class="text-right form-control pull-left decimal-amount-input" /> ',"</div>"].join(""),n=function(e,t,n,i){function a(e,t,n){return n=n||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(n)+e}function r(){var t=a(parseInt(e.decimal,10)||0,2),n=parseInt(e.noDecimal,10)||0;return parseFloat(n+"."+t).toFixed(2)}var o=e.config||{};e.currencySym=o.currencySym||"",e.decimal=0,e.noDecimal=0,e.$watch("noDecimal+decimal",function(){var t=r();e.amount=parseFloat(t),i.$setViewValue(e.amount)}),e.$on("$destroy",function(){})};return{restrict:"EA",require:"?ngModel",priority:Number.MAX_VALUE,transclude:!0,link:n,template:t,scope:{amount:"=ngModel",config:"=eBillAmountInput"}}}],e.directives=i}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(require,e,t){"use strict";var i=n(1).ng;e.lpEbillingUtils=function(e,t,n){this.noop=i.noop,this.extend=i.extend,this.bind=i.bind,this.copy=i.copy,this.isObject=i.isObject,this.isFunction=i.isFunction,this.isUndefined=i.isUndefined,this.isTouch="ontouchstart"in window,this.keys=Object.keys,this.resolvePreference=function(t,n){return e.resolvePortalPlaceholders(t)},this.widgetStaticPath=function(e){var t=e.toString().split("/");t.pop();var n=t.join("/");return n=this.resolvePreference(n)},this.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===Object.prototype.toString.call(e)},this.filter=function(t,n){if(e.isEmpty(n))throw new Error("Specify an object criteria");var i=this.keys(n)[0];return t.filter(function(e){var t=!1;return e.hasOwnProperty(i)&&(t=e[i]===n[i]),t})[0]},this.findIndex=function(e,t){var n=this.filter(e,t);return e.indexOf(n)},this.sortBy=function(e,t,n){e.sort(function(e,i){return e[t]<=i[t]?n?1:-1:1})},this.checkDueDate=function(t,n){var i=e.date;return"undefined"!=typeof n?"isToday"===t?i().isSame(i(n),"day"):"isTomorrow"===t?i().add(1,"day").isSame(i(n),"day"):"isYesterday"===t?i().subtract(1,"day").isSame(i(n),"day"):"isPast"===t?i().isAfter(i(n),"day"):n:null},this.dueDateIndicator=function(e){return this.checkDueDate("isToday",e)?"(today)":this.checkDueDate("isTomorrow",e)?"(tommorow)":this.checkDueDate("isYesterday",e)?"(yesterday)":""},this.groupBy=function(e,n,i,a,r){var o,s="",l=[],c="";i=i||"",a=a||"";var d=["dueDate","amount","modifiedDate"];if(!e instanceof Array||e.length<=0)return l;if(d.indexOf(n)<=-1)throw new Error("Unsupported groupby attribute");return this.sortBy(e,n,r),e.forEach(function(e){switch(n){case"amount":c=t("eBillCurrency")(e[n],e.currencySym);break;case"dueDate":case"modifiedDate":i=i;var r=e[n];c=r&&t("date")(r,"MMM dd").toString().toLowerCase();var d=this.checkDueDate("isPast",r)?a:this.dueDateIndicator(r)}c!==s&&(o={label:[i,c,d].join(" "),bills:[]},s=c,l.push(o)),o&&o.bills instanceof Array&&o.bills.push(e)}.bind(this)),l},this.error=function(e){throw new Error(e)},this.log=function(){if("localhost"===location.hostname.toLowerCase()){var e=[].slice.call(arguments,0);this.isFunction(n.log)&&n.log.apply(n.log,e)}},this.info=function(){if("localhost"===location.hostname.toLowerCase()){var e=[].slice.call(arguments,0);this.isFunction(n.info)&&n.info.apply(n.info,e)}}},e.lpEbillingUtils.$inject=["lpCoreUtils","$filter","$log"]}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;(function(e){i=function(require,e,t){"use strict";t.name="new-payment-box";var i=n(1),a=n(2),r=n(3),o=[a.name,r.name];t.exports=i.createModule(t.name,o).directive(n(13)).directive(n(14)).directive(n(15))}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))}).call(t,n(12)(e))},function(e,t,n){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){var i;i=function(require,e,t){"use strict";var n='<div class="lp-new-payment-box"><div class="form-group" ng-if="eBill"><div class="clearfix"><div class="radio col-xs-7"><label class="control-label"><input type="radio" name="statementBalanceAmount" ng-click="setEBillAmount(eBill.outstandingBalance)" ng-model="paymentAmountSelection" value="statement" /><span>Statement Balance</span></label></div><div class="col-xs-5 col-sm-2 text-right"><span class="radio h5">{{eBill.outstandingBalance}}</span></div></div><div class="clearfix"><div class="radio col-xs-7"><label class="control-label"><input type="radio" name="minimumAmount" ng-click="setEBillAmount(eBill.amountDue)" ng-model="paymentAmountSelection" value="minimum"  /><span>Minimum Amount</span></label></div><div class="col-xs-5 col-sm-2 text-right"><span class="radio h5">{{eBill.amountDue}}</span></div></div><div class="form-group clearfix"><div class="radio col-xs-7"><label class="control-label"><input type="radio" name="SpecificAmount" ng-click="setEBillAmount(0)" ng-model="paymentAmountSelection" value="specific" /><span>Specified Amount</span></label></div><div class="col-xs-5 lp-currency-amount-input" ng-show="isSpecificPaymentSelected()""><div class="amount-area" name="amount" ng-model="paymentOrder.amount"e-bill-amount-input="{currencySym: bill.currencySym }"></div></div></div></div><div class="form-group clearfix" ng-if="!eBill"><label class="col-xs-12 col-sm-12 control-label">Amount to pay</label><div class="col-xs-12 col-sm-12 col-md-7 lp-currency-amount-input"><div class="amount-area" name="amount" ng-model="paymentOrder.amount"e-bill-amount-input="{ currencySym: paymentOrder.currencySym }" required="required"></div></div></div><div class="form-group clearfix"><label class="col-xs-12 col-sm-12 control-label">Pay with</label><div class="col-xs-12 col-sm-12"><div name="accountId" class="lp-accounts-header" ng-change=""lp-accounts-select="lp-accounts-select"ng-model="paymentOrder.account"lp-accounts="accounts" required="required"></div></div></div><div lp-payment-date-box payment-order="paymentOrder" show-urgent-transfer="showUrgentTransfer()"scheduled-transfer-frequencies="scheduledTransferFrequencies"scheduled-transfer-end-options="scheduledTransferEndOptions"></div><div class="memo"><textarea aria-label="payment description" class="form-control memo-area"placeholder="Description (optional) Maximum number of characters is 140"maxlength="140"ng-model="paymentOrder.memo"></textarea></div></div>';e.lpNewPaymentBox=function(){var e=function(e,t,n){e.paymentAmountSelection="statement",e.setEBillAmount=function(t){e.paymentOrder.amount=t},e.isSpecificPaymentSelected=function(){return"specific"===this.paymentAmountSelection}};return{restrict:"A",scope:{paymentOrder:"=payment",accounts:"=accounts",eBill:"=?",showUrgentTransfer:"&",scheduledTransferFrequencies:"=?",scheduledTransferEndOptions:"=?"},replace:!0,link:e,template:n}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(require,e,t){"use strict";var n='<div class="lp-onetime-transfer"><div modal-dialog="" show="urgentTransferModalShown" closable="false"><div class="modal-header"><h2><i class="lp-icon lp-icon-xxl lp-icon-info-sign"></i> <span lp-i18n="Urgent Transfer"></span></h2></div><div class="modal-body" lp-i18n="If you need to send money fast and cannot wait for the usual bank time of approx. 1-2 days then Urgent Transfer allows you to pass the money across in a 5 minute window instead. However, it does come with a 5$ charge and this will appear as a separate transaction in your activity view."></div><div class="modal-footer"><button type="button" class="btn btn-primary" ng-click="toggleUrgentTransferModal()" lp-i18n="Close"></button></div></div><div class="one-time clearfix"><div class="pull-left text" lp-i18n="Sending date"></div><div class="pull-left date-picker"><input ng-click="isOpenDate = !isOpenDate" required="required" type="text" name="scheduleDate"ng-model="paymentOrder.scheduleDate" datepicker-popup="dd-MMM-yyyy"min-date="todaysDate" is-open="isOpenDate" class="form-control" lp-future-time=""datepicker-options="dateOptions" show-button-bar="false" tabindex="0" placeholder="select date"aria-label="select date" /><span ng-click="isOpenDate = !isOpenDate" class="lp-icon lp-icon-calendar calendar-icon"></span></div></div><div class="delivery-date clearfix" ng-if="estimatedDeliveryDate"><div class="pull-left text" lp-i18n="Delivery Date:"></div><span>{{estimatedDeliveryDate}}</span></div><div class="urgent-transfer clearfix" ng-show="showUrgentTransfer()"><div class="urgent-checkbox pull-left"><input aria-label="urgent transfer" ng-model="paymentOrder.urgentTransfer" type="checkbox" /></div><div class="urgent-message pull-left"><span class="text-muted"><span lp-i18n="Make transfer urgent"></span></span></div></div><p ng-show="paymentOrder.urgentTransfer" class="urgent-transfer-message"><span lp-i18n="Making an urgent transfer will incur an extra cost. This will appear on your transactions as a separate transaction."></span></p></div>';e.lpOnetimeTransfer=function(){var e=function(e,t,n){};return{restrict:"A",scope:{paymentOrder:"=",estimatedDeliveryDate:"=?",showUrgentTransfer:"&"},link:e,replace:!0,template:n}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(require,e,t){"use strict";var n='<form name="PaymentDateBoxForm" class="lp-payment-date-box"><div class="e-bill-info-wrapper"><ul tabset="tabset" class="tabset"><li tab="tab" select="onetimeTransfer()"><span tab-heading="tab-heading" class="tab-heading" lp-i18n="One Time"></span><div lp-onetime-transfer payment-order="paymentOrder" estimated-delivery-date="paymentOrder.estDeliveryDate" show-urgent-transfer="showUrgentTransfer()"></div></li><li tab="tab" select="scheduledTransfer()"><span tab-heading="tab-heading" class="tab-heading" lp-i18n="Scheduled"></span><div scheduled-transfer="scheduled-transfer" ng-model="paymentOrder.scheduledTransfer"></div></li></ul></div></form>';e.lpPaymentDateBox=function(){var e=function(e,t,n){e.onetimeTransfer=function(){e.paymentOrder.isScheduledTransfer=!1},e.scheduledTransfer=function(){e.paymentOrder.isScheduledTransfer=!0}};return{restrict:"A",replace:!0,scope:{paymentOrder:"=",showUrgentTransfer:"&?",frequencies:"=?scheduledTransferFrequencies",endOptions:"=?scheduledTransferEndOptions"},template:n,link:e}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))}])});