!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("base"),require("core")):"function"==typeof define&&define.amd?define(["base","core"],e):"object"==typeof exports?exports["module-automation"]=e(require("base"),require("core")):t["module-automation"]=e(t.base,t.core)}(this,function(t,e){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var o;(function(t){o=function(require,t,e){"use strict";e.name="module-automation";var o=n(1),r=n(2),i=[r.name];e.exports=o.createModule(e.name,i).provider(n(3))}.call(e,n,e,t),!(void 0!==o&&(t.exports=o))}).call(e,n(4)(t))},function(e,n,o){e.exports=t},function(t,n,o){t.exports=e},function(t,e,n){var o;o=function(require,t,e){"use strict";var o=n(1).utils,r={headers:{"Content-Type":"application/json"}},i=function(t){return t.forEach(function(e,n){var r,i=o.keys(e)[0],u=e[i];r=[{value:u.value,condition:u.condition?u.condition.value:"gt"}],t[n][i]=r}),t},u=function(t){if(!t||!t.triggerDefinition||!t.triggerDefinition.selectors)return t;var e=[],n=t.triggerDefinition.selectors,r=o.keys(n)||[];return r.forEach(function(t){e.push({name:t,returnType:n[t]})}),t.selectors=e,t},a=function(t){var e={name:t.data.name,isActive:t.data.enabled,trigger:{id:t.trigger.triggerDefinition.name,selectors:{accountId:t.data.accountId||null},filters:i(t.data.filters)},actions:t.data.actions};return t.id&&(e.id=t.id),t.parent&&(e.parent=t.parent),e};t.lpAutomation=function(){var t,e="automationsEndpoint",n="automationEndpoint",i="automationsActivationEndpoint",c="automationsDeactivationEndpoint",s="recipesEndpoint";this.$get=function(p,l,f,d){var g=function(){};return g.prototype.setConfig=function(e){return t=f(e).chain().mapValues(f.resolvePortalPlaceholders).defaults(t).value(),this},g.prototype.getConfig=function(e){return e&&f.isString(e)?t[e]:t},g.prototype.loadAutomations=function(){var t=this;return p.get(t.getAttribute(e)).then(function(t){return t&&null!==t&&"null"!==t&&t.data&&"string"!=typeof t.data||(t={}),t.data||[]})},g.prototype.loadRecipes=function(){var t=this;return this.recipes=[],p.get(t.getAttribute(s)).then(function(e){var n;e&&null!==e&&"null"!==e&&e.data&&"string"!=typeof e.data||(e={}),n=e.data||[];for(var o=0;o<n.length;o++)t.recipes[o]=n[o];return t.recipes})},g.prototype.create=function(t){var n=this,o=a(t);return p.post(n.getAttribute(e),o,r).then(function(t){return t.result=o,t},function(){console.log("save error")})},g.prototype.update=function(t){var e=this,o=a(t);return p.put(e.getAttribute(n),o,r).then(function(t){return o},function(t){console.log("update error")})},g.prototype.toggleStatus=function(t){var e=this,n=t.isActive?c:i;return p.put(e.getAttribute(n).replace("{id}",t.id)).then(function(t){return t},function(t){console.log("toggle status error")})},g.prototype.remove=function(t){var e=this;return p["delete"](e.getAttribute(n)+t).then(function(t){return t},function(t){console.log("remove error")})},g.prototype.getAttribute=function(e){return t[e]},g.prototype.getAccountFlag=function(t){return t.triggerDefinition.selectors.accountId},g.prototype.getActionLocation=function(t){return o.keys(t.location)[0]||!1},g.prototype.normalizeTrigger=u,new g},this.$get.$inject=["$http","$q","lpCoreUtils","lpCoreBus"]}}.call(e,n,e,t),!(void 0!==o&&(t.exports=o))},function(t,e,n){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}}])});