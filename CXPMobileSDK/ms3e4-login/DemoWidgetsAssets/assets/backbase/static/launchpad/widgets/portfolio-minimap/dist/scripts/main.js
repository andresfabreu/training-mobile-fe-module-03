!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("base"),require("ui"),require("module-wealth"),require("d3")):"function"==typeof define&&define.amd?define(["base","ui","module-wealth","d3"],t):"object"==typeof exports?exports["widget-portfolio-minimap"]=t(require("base"),require("ui"),require("module-wealth"),require("d3")):e["widget-portfolio-minimap"]=t(e.base,e.ui,e["module-wealth"],e.d3)}(this,function(e,t,n,r){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r;(function(e){r=function(require,e,t){"use strict";function r(e,t){t.setConfig({portfolioEndPoint:e.getPreference("dataSrc")})}t.name="widget-portfolio-minimap";var a=n(1),i=n(2),o=n(3),l=[i.name,o.name];r.$inject=["lpWidget","lpWealth"],t.exports=a.createModule(t.name,l).controller(n(4)).directive(n(5)).run(r)}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}).call(t,n(6)(e))},function(t,n,r){t.exports=e},function(e,n,r){e.exports=t},function(e,t,r){e.exports=n},function(e,t,n){var r;r=function(require,e,t){"use strict";var n=31556952e3,r=[{name:"10 years",value:10*n},{name:"5 years",value:5*n},{name:"3 years",value:3*n},{name:"1 year",value:n},{name:"9 months",value:.75*n},{name:"6 months",value:n/2},{name:"3 months",value:n/4},{name:"1 month",value:n/12}],a={monthly:"Monthly",yearly:"Yearly"};e.MainCtrl=function(e,t,n){function i(e){var t=e[u.frequency],n=t[t.length-1].date-t[0].date;return l.spans=r.filter(function(e){return e.value<n}),e}function o(e){l.loading=!1,l.data=e}var l=this,u=l.config={timespan:n.getConfig("timespan"),frequency:n.getConfig("frequency")};l.freqs=a,l.spans=r,l.setFreq=function(e){u.frequency=e,t.publish("portfolio-frequency",e)},l.setSpan=function(e){u.timespan=e},t.subscribe("launchpad-retail.portfolioSelected",function(t){l.loading=!0,e.getData(t.id).then(i).then(o)})},e.MainCtrl.$inject=["ptfModel","lpCoreBus","lpWealth"]}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))},function(e,t,n){var r;r=function(require,e,t){"use strict";function r(e,t){var n=new Date(e);return-1===t.indexOf("year")?n.setMonth(e.getMonth()-parseInt(t,10)):n.setFullYear(e.getFullYear()-parseInt(t,10)),[n,e]}var a=n(7),i=n(1).ng,o="<svg></svg>",l=a.time.format.multi([["%Y",function(e){return 0===e.getMonth()}],["%b",function(e){return 1===e.getDate()}],["",function(){return!0}]]),u=-10,c=-20;e.lpWealthMinimap=function(e,t,n,s){function f(o,s){function f(e){return function(){var t=A.empty()?q.domain():A.extent();p.publish(e,t)}}function h(e,t){var n=r(e,t),a=q.domain();n[0]<a[0]&&(n[0]=a[0]),A.extent(n),M.select(".brush").call(A),x()}function g(){var e=o.data;e&&(e=e[y.frequency],q.domain(a.extent(e,d)),w.domain(a.extent(e,m)),M.select(".area").datum(e).attr("d",C),M.select(".x.axis").call($).selectAll("text").attr("transform","translate(0,"+c+")"),h(q.domain()[1],y.timespan))}function v(){var e=s.innerWidth(),t=s.innerHeight();0>=e||0>=t||(q.range([0,e]),w.range([t,0]),C.y0(t),M.attr({width:e,height:t}),M.select(".x.axis").attr("transform","translate(0,"+(t+u)+")"),M.select(".x.brush").selectAll("rect").attr("height",t),M.select(".x.brush").selectAll(".drg").attr({height:t/2,y:t/4}),g())}var x,y=o.config,b=s.find("svg")[0],M=a.select(b),q=a.time.scale(),w=a.scale.linear(),$=a.svg.axis().scale(q).orient("bottom").tickFormat(l),A=a.svg.brush().x(q),C=a.svg.area().x(function(e){return q(e.date)}).y1(function(e){return w(m(e))});M.append("path").attr("class","area"),M.append("g").attr("class","x axis");var W=M.append("g").attr("class","x brush").call(A).selectAll(".resize");W.append("rect").attr({"class":"drg",width:5,x:function(e,t){return t?0:-5.5}}),W.append("path").attr("d",function(e,t){return t?"M1,16v20M3,16v20":"M-2,16v20M-4,16v20"}),x=f("portfolio-rangeSelected"),A.on("brush",f("portfolio-rangeSelected-live")).on("brushend",x),v(),n.sticky(s,50),o.$watch("data",g),o.$watch("config.timespan",function(e){h(A.extent()[1],e)}),o.$on("$destroy",function(){}),i.element(e).on("resize",t.debounce(v,250))}var p=s,d=t.property("date"),m=function(e){return e.datapoint.totalPortfolioValue};return{restrict:"EA",require:"?ngModel",priority:Number.MAX_VALUE,link:f,template:o,scope:{data:"=ngModel",config:"=lpWealthMinimap",onRender:"&onRender"}}},e.lpWealthMinimap.$inject=["$window","utils","wealthUtils","lpCoreBus"]}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))},function(e,t,n){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){e.exports=r}])});