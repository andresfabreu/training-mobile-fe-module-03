!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("base"),require("ui"),require("core"),require("module-accounts")):"function"==typeof define&&define.amd?define(["base","ui","core","module-accounts"],n):"object"==typeof exports?exports["widget-external-accounts"]=n(require("base"),require("ui"),require("core"),require("module-accounts")):e["widget-external-accounts"]=n(e.base,e.ui,e.core,e["module-accounts"])}(this,function(e,n,t,i){return function(e){function n(i){if(t[i])return t[i].exports;var o=t[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){var i;(function(e){i=function(require,e,n){"use strict";n.name="widgets-external-accounts";var i=t(1),o=t(2),c=t(3),r=t(4),l=[c.name,o.name,r.name];n.exports=i.createModule(n.name,l).controller(t(5)).directive(t(6))}.call(n,t,n,e),!(void 0!==i&&(e.exports=i))}).call(n,t(7)(e))},function(n,t,i){n.exports=e},function(e,t,i){e.exports=n},function(e,n,i){e.exports=t},function(e,n,t){e.exports=i},function(e,n,t){var i;i=function(require,e,n){"use strict";e.ExternalAccountsController=function(e,n,t,i,o,c,r){var l=function(){e.fiModel=i.getInstance({financialInstitutesEndpoint:n.getPreference("financialInstitutionsSrc"),membershipRequestsEndpoint:n.getPreference("membershipRequestsSrc")}),e.partialsDir=c.getWidgetBaseUrl(n)+"/partials/",e.increment=parseInt(n.getPreference("amountToLoad"),10)||5,e.searchIndex=1,e.typeFilters={all:{label:"All",code:"",selected:!0},loan:{label:"Loans",code:"LOAN",selected:!1},"credit-cards":{label:"Credit Cards",code:"CREDIT_CARD",selected:!1},checking:{label:"Checking/Savings",code:"CHECKING,SAVINGS",selected:!1}},e.search={name:"",typeFilter:""},e.contextLabel="All",o.loadMessages(n,e.locale).success(function(n){e.messages=n.messages}),e.fiModel.isConnecting=!0,e.fiModel.searchFinancialInstitutes({f:e.searchIndex,l:e.increment,name:"",accountTypes:[]}).then(function(){e.searchIndex=e.searchIndex+e.increment})["finally"](function(){e.fiModel.isConnecting=!1})};e.restartWizard=function(){e.reset(),e.goToWizardStep(1)},e.reset=function(){e.fiModel.isConnecting=!1,e.fiModel.selectedMembership={},e.fiModel.clearErrors(),e.fiModel.clearWarnings()},e.loadAccounts=function(){e.reset(),t(function(){},2e3)},e.close=function(){r.publish("launchpad-retail.closeActivePanel")},l()},e.ExternalAccountsController.$inject=["$scope","lpWidget","$timeout","FinancialInstituteModel","i18nUtils","lpCoreUtils","lpCoreBus"],e.FinancialInstitutionListController=function(e,n,t,i){e.noMoreFIs=!1,e.selectFI=function(n,t){if(13===t.which||"click"===t.type){e.fiModel.setSelected(n),e.fiModel.isConnecting=!0;var i=e.fiModel.getRequiredCredentials();i.then(function(n){for(var t,i=0;i<e.fiModel.selected.requiredUserCredentials.length;i++)t=e.fiModel.selected.requiredUserCredentials[i],t.fieldValue="";e.fiModel.isConnecting=!1,e.wizardNextStep()},function(){e.fiModel.isConnecting=!1})}},e.searchForFinancialInstitute=function(n){return e.fiModel.isConnecting=!0,e.fiModel.searchFinancialInstitutes({f:e.searchIndex,l:e.increment,name:e.search.name,accountTypes:e.search.typeFilter},n).then(function(n){e.fiModel.isConnecting=!1,n.length<e.increment?e.noMoreFIs=!0:e.searchIndex=e.searchIndex+e.increment},function(){e.fiModel.isConnecting=!1})},e.resetSearchIndex=function(){e.searchIndex=1,e.noMoreFIs=!1},e.searchForFIByKeyword=i.debounce(function(){e.resetSearchIndex(),e.searchForFinancialInstitute()},500),e.disableEnterSubmit=function(e){return e&&13===e.which?void e.preventDefault():void 0},e.filterFIsByType=function(n,t){t&&13!==t.which||(e.resetSearchIndex(),i.forEach(e.typeFilters,function(e){e.selected=!1}),e.search.typeFilter=e.typeFilters[n].code,e.typeFilters[n].selected=!0,e.contextLabel=n?e.typeFilters[n].label:"All",e.searchForFinancialInstitute())}},e.FinancialInstitutionListController.$inject=["$scope","$element","$timeout","lpCoreUtils"],e.CredentialsViewController=function(e,n){e.pollCount=0,e.authenticateWithSelectedFI=function(){e.fiModel.clearErrors(),e.fiModel.isConnecting=!0;var n;n=e.fiModel.selectedMembership.id?e.fiModel.updateMembershipRequest(e.fiModel.selectedMembership):e.fiModel.createMembershipRequest(e.fiModel.selected),n.then(function(n){e.handleAuthenticationResponse(n)},function(){e.fiModel.isConnecting=!1})},e.updateRequiredCredentials=function(n){e.fiModel.addWarning({captionCode:"extraAuth"}),e.fiModel.selected.requiredUserCredentials=n.credentials,e.fiModel.isConnecting=!1},e.pollForAuth=function(t){n(function(){if(e.pollCount<10){var n=e.fiModel.loadMembershipRequestByID(t);n.then(function(n){e.handleAuthenticationResponse(n),e.pollCount++},function(){e.fiModel.isConnecting=!1,e.pollCount=0})}else e.fiModel.addError({captionCode:"badConnection"}),e.pollCount=0},2e3)},e.handleAuthenticationResponse=function(n){switch(n.status){case"CREATED":e.wizardNextStep(),e.loadAccounts();break;case"CHALLENGE":e.fiModel.selected.extraAuthRequired=!0,e.updateRequiredCredentials(n);break;case"PENDING":e.pollForAuth(n.id)}}},e.CredentialsViewController.$inject=["$scope","$timeout"]}.call(n,t,n,e),!(void 0!==i&&(e.exports=i))},function(e,n,t){var i;i=function(require,e,n){"use strict";var t=window.jQuery;e.lazyLoader=function(e,n){return{restrict:"A",scope:{callBack:"=",stopLoading:"="},link:function(i,o,c){var r,l=function(){return i.widgetElement.height()+i.widgetElement.offset().top},s=n.debounce(function(){r.scrollTop()>l()-150&&(r.off("scroll",s),i.callBack(!0).then(function(){i.stopLoading||r.on("scroll",s)}))},10),a=function(){r=t(e),i.widgetElement=o.closest(".widget"),r.on("scroll",s)};i.$watch("stopLoading",function(n,i){n?t(e).off("scroll",s):i&&!n&&r.on("scroll",s)}),a()}}},e.lazyLoader.$inject=["$window","lpCoreUtils"]}.call(n,t,n,e),!(void 0!==i&&(e.exports=i))},function(e,n,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}}])});