!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("base"),require("core"),require("ui"),require("module-ebilling")):"function"==typeof define&&define.amd?define(["base","core","ui","module-ebilling"],t):"object"==typeof exports?exports["widget-billpay-dashboard"]=t(require("base"),require("core"),require("ui"),require("module-ebilling")):e["widget-billpay-dashboard"]=t(e.base,e.core,e.ui,e["module-ebilling"])}(this,function(e,t,n,a){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var a;(function(e){a=function(require,e,t){"use strict";function a(){}t.name="billpay-dashboard";var r=n(1),i=n(2),c=n(3),s=n(4),o=[i.name,c.name,s.name];t.exports=r.createModule(t.name,o).controller(n(5)).service(n(6)).directive(n(7)).run(a)}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))}).call(t,n(8)(e))},function(t,n,a){t.exports=e},function(e,n,a){e.exports=t},function(e,t,a){e.exports=n},function(e,t,n){e.exports=a},function(e,t,n){var a;a=function(require,e){"use strict";var t=n(1).utils;e.MainCtrl=function(){},e.PayeeListCtrl=function(e,n,a){var r=this,i=function(e){r.ebillPayees={},r.othPayees=[],t.forEach(e,function(e,t){if("ACTIVE"===e.eBillsStatus){var n=a.formatDate(e.eBill.dueDate,"MMM dd");r.ebillPayees[n]?r.ebillPayees[n].push(e):r.ebillPayees[n]=[e]}else r.othPayees.push(e)})};r.fetchPayees=function(){r.isLoading=!0,n.fetchPayees().then(function(e){r.payees=e.data.payees,i(r.payees),r.isLoading=!1})},r.fetchAccounts=function(){n.fetchAccounts().then(function(t){e.accounts=t})},r.fetchFrequencies=function(){n.fetchFrequencies().then(function(t){e.frequencies=t})},r.init=function(){r.payees=[],r.fetchPayees(),r.fetchAccounts(),r.fetchFrequencies()}},e.PayeeListCtrl.$inject=["PayeeModel","PayeeService","CalendarService"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";var a="",r=n(1).utils;e.PayeeModel=function(e){this.accounts=[],this.frequencies=[],this.paymentMethods={CHECK:"CHECK",ELECTRONIC:"ELECTRONIC"},this.endOptionsEnum={AFTER:"after",CANCEL:"onCancel"},this.endOptions=[{id:this.endOptionsEnum.AFTER,value:e("translate")("After")},{id:this.endOptionsEnum.CANCEL,value:e("translate")("On cancellation")}]},e.PayeeModel.$inject=["$filter"],e.PayeeService=function(e,t,n,i,c,s){var o=i.resolvePortalPlaceholders(n.getPreference("billPaymentsDataSrc"));this.fetchPayees=function(){return e.get(o+"/payees?"+a)},this.fetchAccounts=function(){return e.get(o+"/accounts?"+a).then(function(e){var t=[];return r.forEach(e.data.accounts,function(e,n){var a={alias:e.nickName||e.description,identifier:e.accountCode,bookedBalance:e.totalAmountDue,availableBalance:e.balance,isPrimaryAccount:e.primaryBillPaymentAccount};a.isPrimaryAccount&&(s.defaultAccount=a),t.push(a)}),t})},this.fetchFrequencies=function(){return e.get(o+"/frequencies?"+a).then(function(e){var n=[];return r.forEach(e.data.frequencies,function(e,a){n.push({id:e,value:t("translate")(e)})}),n})};var u=function(e,t){var n={payeeId:e.payeeId,accountCode:t.account&&t.account.identifier,amount:t.amount,memo:t.memo};return t.isScheduledTransfer?(n.frequency=t.scheduledTransfer.frequency||"OneTime",n.processingDate=c.formatDate(t.scheduledTransfer.startDate),"onCancel"===t.scheduledTransfer.endOn?n.repeatUntilCanceled=!0:n.numberOfPayments=t.scheduledTransfer.timesToRepeat):(n.frequency="OneTime",n.processingDate=c.formatDate(t.scheduleDate),n.repeatUntilCanceled=!1,n.numberOfPayments=1),n};this.submitPayment=function(t,n){var r=u(t,n),i="/payments?";return n.urgentTransfer&&(i="/expedited-payments?"),e.post(o+i+a,{payment:r})}},e.PayeeService.$inject=["$http","$filter","lpWidget","lpCoreUtils","CalendarService","PayeeModel"],e.CalendarService=function(e,t,n,r){var i=n.resolvePortalPlaceholders(t.getPreference("calendarDataSrc"));this.formatDate=function(e,t){return t||(t="yyyy-MM-dd"),r("date")(e,t)},this.getBusinessDay=function(t,n){var r=this.formatDate(t);return e.get(i+"/business-days-after"+a,{params:{date:r,offset:n}}).then(function(e){return e.data.businessDay},function(e){return e.data&&e.data.errors})}},e.CalendarService.$inject=["$http","lpWidget","lpCoreUtils","$filter"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(require,e,t){"use strict";e.payeeListItem=function(e,t,n,a,r,i,c){var s=function(e,t,n,a){e.payee.opened=!1,e.payeeModel=r,e.payee.accountMask&&(e.payee.accountMask="******** "+e.payee.accountMask),e.onClick=function(t){e.payee.opened=!e.payee.opened}},o=n.getWidgetBaseUrl(a)+"/templates";return{restrict:"EA",require:"?ngModel",link:s,templateUrl:o+"/list-item.ng.html",scope:{payee:"=ngModel"}}},e.payeeListItem.$inject=["$timeout","$compile","lpCoreUtils","lpWidget","PayeeModel","PayeeService","CalendarService"],e.payeeContent=function(e,t,n,a,r,i,c){var s=n.getWidgetBaseUrl(a)+"/templates",o=function(t,n,a,s){t.payeeModel=r;var o=function(e){if(e){var n=t.payment.urgentTransfer?1:t.payee.businessDaysToDeliver;c.getBusinessDay(e,n).then(function(e){t.payment.estDeliveryDate=e})}};t.$watch("payment.urgentTransfer",function(){o(t.payment.scheduleDate)}),t.$watch("payment.scheduleDate",function(e){o(e)});var u=function(){t.payee.payment?t.payment=t.payee.payment:(t.payment={amount:0,scheduleDate:new Date,account:r.defaultAccount,currencySym:"$",isScheduledTransfer:!1,scheduledTransfer:{startDate:new Date,intervals:[],timesToRepeat:1}},t.payee.payment=t.payment)},l=function(e){return t.payee.warnings=[],e.account||t.payee.warnings.push({code:"ERROR_SELECT_ACCOUNT"}),e.scheduleDate||t.payee.warnings.push({code:"ERROR_ENTER_PROCESSING_DATE"}),e.amount||t.payee.warnings.push({code:"ERROR_ENTER_AMOUNT"}),e.isScheduledTransfer&&(e.scheduledTransfer.frequency||t.payee.warnings.push({code:"ERROR_SELECT_FREQUENCY"}),"after"!==e.scheduledTransfer.endOn||e.scheduledTransfer.timesToRepeat||t.payee.warnings.push({code:"ERROR_ENTER_TIMES_TO_REPEAT"})),t.payee.warnings.length>0?!1:!0};t.pay=function(){l(t.payment)&&(t.payee.processing=!0,t.payee.opened=!1,i.submitPayment(t.payee,t.payment).then(function(n){t.payee.response={},t.payee.response.action="success",t.payee.response.message="ALERT_PAYMENT_SUBMITTED",e(function(){delete t.payee.response},3e3)},function(e){t.payee.opened=!0,t.payee.errors=e.data.errors})["finally"](function(){t.payee.processing=!1}))},t.showUrgentTransfer=function(){return t.payee.canExpeditePayments&&t.payee.paymentMethod===r.paymentMethods.CHECK},u()};return{restrict:"EA",link:o,templateUrl:s+"/list-item-content.ng.html",scope:{payee:"="}}},e.payeeContent.$inject=["$timeout","$compile","lpCoreUtils","lpWidget","PayeeModel","PayeeService","CalendarService"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}}])});