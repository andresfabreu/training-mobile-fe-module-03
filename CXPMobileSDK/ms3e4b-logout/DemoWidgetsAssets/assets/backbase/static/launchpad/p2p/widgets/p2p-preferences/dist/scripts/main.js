!function(e,i){"object"==typeof exports&&"object"==typeof module?module.exports=i(require("base"),require("core"),require("ui"),require("module-accounts")):"function"==typeof define&&define.amd?define(["base","core","ui","module-accounts"],i):"object"==typeof exports?exports["widget-p2p-preferences"]=i(require("base"),require("core"),require("ui"),require("module-accounts")):e["widget-p2p-preferences"]=i(e.base,e.core,e.ui,e["module-accounts"])}(this,function(e,i,r,n){return function(e){function i(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var r={};return i.m=e,i.c=r,i.p="",i(0)}([function(e,i,r){var n;(function(e){n=function(require,e,i){"use strict";function n(){}i.name="widget-p2p-preferences";var o=r(1),t=r(2),a=r(3),l=r(4),c=[t.name,a.name,l.name];i.exports=o.createModule(i.name,c).controller(r(5)).run(n)}.call(i,r,i,e),!(void 0!==n&&(e.exports=n))}).call(i,r(6)(e))},function(i,r,n){i.exports=e},function(e,r,n){e.exports=i},function(e,i,n){e.exports=r},function(e,i,r){e.exports=n},function(e,i,r){var n;n=function(require,e,i){"use strict";e.P2PPreferencesController=function(e,i,r,n,o,t,a,l,c){var u=c,s=function(){var i=r.getWidgetBaseUrl(o)+"/templates";e.locale=o.getPreference("locale"),e.p2pService=a,e.p2pProvider={name:"Backbase P2P Service",icon:"lp-icon-bb-logo"},e.p2pUserDetails={depositAccount:{},emails:[]},e.emailErrors={messages:{invalid_email:"Invalid Email"},errors:[]},e.p2pService.getUserEnrollmentDetails().then(function(i){e.userEnrolled=!0,e.p2pUserDetails.depositAccount={value:i.data.accountNumber,options:[]},e.p2pUserDetails.emails=[{value:i.data.email,primary:!0,verified:i.data.emailVerified}]},function(i){u.subscribe("launchpad-retail.userP2PEnrolled",function(i){e.$apply(function(){e.userEnrolled=i.enrolled,e.p2pUserDetails.depositAccount.value=i.enrollment.account.iban,e.p2pUserDetails.emails.push({value:i.enrollment.email.value,primary:!0,verified:!1})})}),e.userEnrolled=!1,404!==i.status&&(e.p2pService.error=!0)}),e.accountsModel=t,e.accountsModel.setConfig({accountsEndpoint:o.getPreference("accountsDataSrc")}),e.accountsModel.load().then(function(){e.p2pUserDetails.depositAccount.options=e.accountsModel.accounts}),e.currentEmail={},e.verify={validationError:!1,verificationCode:"",modalShown:!1},e.templates={verify:i+"/verify-email.html"}};e.validateEmail=function(e){var i=r.isValidEmail(e);return i?!0:"invalid_email"},e.saveEmail=function(i,r){r.value||(r.value=""),r.verified=!1,e.p2pService.editP2PEnrollment({email:r.value}),u.publish("launchpad-retail.userP2PVerification.unverified")},e.beginVerification=function(i){e.currentEmail=i,e.verify.modalShown=!0},e.handleEmailVerification=function(){e.p2pService.verifyCode(e.currentEmail.value,e.verify.verificationCode).then(function(i){200===i.status&&(e.currentEmail.verified=!0,e.verify.modalShown=!1,e.verify.verificationCode="",e.verify.validationError=!1)},function(i){409===i.status&&(e.verify.validationError=!0)})},e.closeVerifyModal=function(){e.verify.modalShown=!1,e.verify.verificationCode="",e.verify.validationError=!1},e.saveAccount=function(i){e.p2pService.editP2PEnrollment({accountNumber:i})},e.enroll=function(){u.publish("launchpad-retail.openP2PEnrollment")},s()},e.P2PPreferencesController.$inject=["$scope","$templateCache","lpCoreUtils","$timeout","lpWidget","AccountsModel","P2PService","i18nUtils","lpCoreBus"]}.call(i,r,i,e),!(void 0!==n&&(e.exports=n))},function(e,i,r){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}}])});