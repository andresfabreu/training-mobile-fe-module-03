!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("base"),require("module-users")):"function"==typeof define&&define.amd?define(["base","module-users"],e):"object"==typeof exports?exports["module-contacts"]=e(require("base"),require("module-users")):t["module-contacts"]=e(t.base,t["module-users"])}(this,function(t,e){return function(t){function e(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return t[o].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var o;(function(t){o=function(require,t,e){"use strict";e.name="module-contacts";var o=n(1),a=n(2),c=[a.name];e.exports=o.createModule(e.name,c).factory(n(3))}.call(e,n,e,t),!(void 0!==o&&(t.exports=o))}).call(e,n(4)(t))},function(e){e.exports=t},function(t){t.exports=e},function(t,e,n){var o;o=function(require,t){"use strict";t.ContactsModel=function(t,e,n,o){var a=function(t){t=t||{},this.defaults={locale:t.locale,contactListEndpoint:t.contacts,contactDataServiceEndpoint:t.contactData,contactDetailsServiceEndpoint:t.contactDetails,metaDataEndpoint:t.metaData},this.locale=t.locale,t.contactDetails&&(this.contactDetailsData=[]),this.contacts=[],t.lazyload||this.loadContacts()};return a.prototype.loadContacts=function(){var e=this,n=t.get(this.defaults.contactListEndpoint);return this.loading=!0,n.success(function(t){e.contacts=t&&"null"!==t?e.preprocessContacts(t):[]}),n.error(function(t){e.error={message:t.statusText}}),n["finally"](function(){e.loading=!1}),n},a.prototype.loadContactDetails=function(e){var o=this;if(this.contactDetailsData.length>0&&n.forEach(this.contactDetailsData,function(t){return t&&t.id===e?(o.currentDetails=t,void(o.detailsLoaded=!0)):void 0}),!this.detailsLoaded){this.loading=!0;var a=t({url:this.defaults.contactDetailsServiceEndpoint,method:"GET",params:{contactId:e}});return a.success(function(t){o.currentDetails=t,o.contactDetailsData.push(o.currentDetails)}),a.error(function(t){o.error={message:t.statusText}}),a["finally"](function(){o.loading=!1}),a}this.detailsLoaded=!1},a.prototype.preprocessContacts=function(t){return e(t,"name")},a.prototype.createContact=function(e){if(!e)return!1;var a=this,c=this.currentContact.id,r={contactId:c};this.currentContact.photoUrl=o(this.currentContact.name,77,77),this.sendXhrRequest(t({method:"POST",url:this.defaults.contactDataServiceEndpoint,params:r,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:n.buildQueryString(this.currentContact)}));var i=function(){a.contacts.push(a.currentContact),a.contactDetailsData.push(a.currentDetails),a.refreshModel()};return this.sendXhrRequest(t({method:"POST",url:this.defaults.contactDetailsServiceEndpoint,params:r,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:n.buildQueryString(this.currentDetails)}),i)},a.prototype.createCounterParty=function(e){if(!e)return!1;var o=this,a=function(){o.contacts.push(o.currentContact)};return this.sendXhrRequest(t({method:"POST",url:this.defaults.contactListEndpoint,data:n.buildQueryString(this.currentContact)}),a)},a.prototype.updateContact=function(e){if(!e)return!1;var a=this,c=a.currentContact.id,r=function(t,e){var o={};return n.forEach(e,function(e,a){n.forEach(t,function(t){t===a&&(o[a]=e)})}),o},i=function(t,e){return n.forEach(t,function(t){e[t]||(e[t]=null)}),e};void 0===a.currentContact.photoUrl&&(a.currentContact.photoUrl=o(a.currentContact.name,77,77));var s=["name","id","photoUrl","partyId","account"],u=r(s,a.currentContact),l=function(){a.contacts[a.index]=a.currentContact,a.refreshModel()};this.sendXhrRequest(t({method:"PUT",url:this.defaults.contactDataServiceEndpoint,params:{contactId:c},headers:{"Content-Type":"application/x-www-form-urlencoded"},data:n.buildQueryString(u)}),l);var d=["address","city","state","dateOfBirth","email","phone","id"],h=r(d,a.currentDetails),f=i(d,h),p=function(){a.contactDetailsData.length>0&&n.forEach(a.contactDetailsData,function(t){return t&&t.id===c?(t=h,void(a.currentDetails=t)):void 0})};return this.sendXhrRequest(t({method:"PUT",url:this.defaults.contactDetailsServiceEndpoint,params:{contactId:c},headers:{"Content-Type":"application/x-www-form-urlencoded"},data:n.buildQueryString(f)}),p)},a.prototype.deleteContact=function(){var e=this,o=e.currentContact.id,a=function(t){n.forEach(e.contacts,function(n){if(n&&n.id===t){var o=e.contacts.indexOf(n);e.contacts.splice(o,1)}}),e.contacts.length>0?e.currentContact=e.contacts[0]:(e.currentContact=null,e.moduleState="contactsNone"),e.refreshModel()};this.sendXhrRequest(t({method:"DELETE",url:this.defaults.contactDataServiceEndpoint,params:{contactId:o}}),a(o))},a.prototype.noContactsFound=function(){var t=!this.loading&&0===this.contacts.length;return t},a.prototype.sendXhrRequest=function(t,e){var o=this;return t.loading=!0,t.success(function(){n.isFunction(e)&&e()}),t.error(function(t){o.error={message:t.statusText}}),t["finally"](function(){t.loading=!1}),t},a.prototype.selectContact=function(t){t&&!this.disableSelection&&(this.contacts.length>0?(this.selected=t.id,this.currentContact=t,this.idx=this.contacts.indexOf(this.currentContact),this.loadContactDetails(this.currentContact.id)):(this.currentContact=null,this.moduleState="contactsNone"))},a.prototype.refreshModel=function(){this.disableSelection=!1,this.currentContact&&(this.selectContact(this.currentContact),this.moduleState="contactsView")},a.prototype.findByName=function(t){return n.find(this.contacts,{name:t})},a},t.ContactsModel.$inject=["$http","orderByFilter","lpCoreUtils","lpDefaultProfileImage"]}.call(e,n,e,t),!(void 0!==o&&(t.exports=o))},function(t){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}}])});